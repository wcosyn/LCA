\documentclass[10pt]{article}

\usepackage{a4wide}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{braket}
\usepackage{todonotes}
\usepackage{bbold}
\usepackage{multicol}


\def\threej#1{\inthreej(#1)}
\def\inthreej(#1,#2,#3,#4,#5,#6){\begin{pmatrix}#1 & #2 & #3 \\ #4 & #5 & #6 \end{pmatrix}}

\def\cgcthreej#1{\incgcthreej(#1)}
\def\incgcthreej(#1,#2,#3,#4,#5,#6){ (-1)^{#1-#2+#6} \sqrt{ 2 #3 + 1 } \begin{pmatrix}#1 & #2 & #3 \\ #4 & #5 & -#6 \end{pmatrix}}

\def\sixj#1{\insixj(#1)}
\def\insixj(#1,#2,#3,#4,#5,#6){\begin{Bmatrix}#1 & #2 & #3 \\ #4 & #5 & #6 \end{Bmatrix}} 

\begin{document}
\section{Momentum distributions}
\section{Second quantization}
This section will be somewhat over-elaborated. But it can serve as a recapitulation of second quantization.

The one body momentum distribution operator is defined as,
\begin{align}
	\hat{n}(p) = \frac{1}{(2 \pi)^{3}} \int \textrm{d}^{2} \Omega_{\mathbf{p}} a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}}
\end{align}
It's action on a multi particle ground state $\ket{\Phi}$,
\begin{align}
	\braket{ \Phi | \hat{n}(p) | \Phi} = \frac{1}{(2 \pi)^{3}} \int \textrm{d}^{2} \Omega_{\mathbf{p}} \braket{ \Phi | a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} | \Phi}
\end{align}
The creation and annihilation operators $a_{\mathbf{p}}^{\dagger}$,$a_{\mathbf{p}}$ have only meaning working on particles with definite momentum or the vacuum state $\ket{0}$.
\begin{align}
	\braket{ \Phi | a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} | \Phi} &= \int \textrm{d}^{3} \mathbf{p}_{1} \ldots \textrm{d}^{3} \mathbf{p}_{A} \braket {\Phi | \mathbf{p}_1 \mathbf{p}_2 \ldots \mathbf{p}_{A}} \braket{ \mathbf{p}_{1} \mathbf{p}_{2} \ldots \mathbf{p}_{A} | a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} | \Phi } \\
	&= \int \textrm{d}^{A} \mathbf{p}_{1} \ldots \textrm{d}^{3} \mathbf{p}_{A} \braket {\Phi | \mathbf{p}_1 \mathbf{p}_2 \ldots \mathbf{p}_{A}} \braket{ 0 | a_{\mathbf{p}_{1}} a_{\mathbf{p}_{2}} \ldots a_{\mathbf{p}_{A}} a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} | \Phi } 
\end{align}
Using the anticommutation relation $\{ a_{\mathbf{p}} ,a_{\mathbf{q}}^{\dagger} \} = \delta(\mathbf{p}-\mathbf{q})$, we get
\begin{align}
	\braket{0 | a_{\mathbf{p}_{1}} a_{\mathbf{p}_{2}} \ldots a_{\mathbf{p}_{A}} a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} | \Phi} &=
	\braket{0 | a_{\mathbf{p}_{1}} a_{\mathbf{p}_{2}} \ldots \delta(\mathbf{p}-\mathbf{p}_{A}) a_{\mathbf{p}} | \Phi} - \braket{0 | a_{\mathbf{p}_{1}} a_{\mathbf{p}_{2}} \ldots a_{\mathbf{p}_{A-1}} a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}_{A}} a_{\mathbf{p}} | \Phi} \\
	&= \delta(\mathbf{p}-\mathbf{p}_{A}) \braket{\mathbf{p}_{1} \mathbf{p}_{2} \ldots \mathbf{p} | \Phi } - \delta(\mathbf{p}-\mathbf{p}_{A-1}) \braket{0 | a_{\mathbf{p}_1} \ldots a_{\mathbf{p}_{A-2}} a_{\mathbf{p}_{A}} a_{\mathbf{p}} | \Phi} \\
	&+ \braket{0| a_{\mathbf{p}_1} \ldots a_{\mathbf{p}_{A-2}} a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}_{A-1}} a_{\mathbf{p}_{A}} a_{\mathbf{p}} | \Phi} \\
 &= \delta(\mathbf{p}-\mathbf{p}_{A}) \braket{\mathbf{p}_{1} \mathbf{p}_{2} \ldots \mathbf{p}_{A} | \Phi } + \delta(\mathbf{p}-\mathbf{p}_{A-1}) \braket{\mathbf{p}_{1} \ldots \mathbf{p}_{A-2} \mathbf{p}_{A-1} \mathbf{p}_{A} | \Phi} \\
	&+ \braket{0| a_{\mathbf{p}_1} \ldots a_{\mathbf{p}_{A-2}} a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}_{A-1}} a_{\mathbf{p}_{A}} a_{\mathbf{p}} | \Phi}
	&= \ldots \\
	&= \sum_{i=1}^{A} \delta(\mathbf{p} - \mathbf{p}_{i}) \braket{ \mathbf{p}_{1} \ldots \mathbf{p}_{A} | \Phi} + (-1)^{A} \underbrace{\braket{ 0 | a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}_1} \ldots a_{\mathbf{p}_{A}} a_{\mathbf{p}} | \Phi}}_{=0}
\end{align}
Hence,
\begin{align}
	\braket{ \Phi | a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} | \Phi} &= \int \textrm{d}^{3} \mathbf{p}_{1} \ldots \textrm{d}^{3} \mathbf{p}_{A} \braket {\Phi | \mathbf{p}_1 \mathbf{p}_2 \ldots \mathbf{p}_{A}} \sum_{i=1}^{A} \delta(\mathbf{p} - \mathbf{p}_{i}) \braket{ \mathbf{p}_{1} \mathbf{p}_{2} \ldots \mathbf{p}_{A} | \Phi}
\end{align}
If $\ket{\Phi}$ is a slater determinant of orthonormal single particle wave functions $\ket{\phi_{\alpha_{i}}}$ we get,
\begin{align}
	\braket{ \Phi | a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} | \Phi} &= \sum_{i=1}^{A} | \braket{ \mathbf{p} | \phi_{\alpha_{i}} } |^{2} = \sum_{i=1}^{A} \phi_{\alpha_i}^{\dagger}(\mathbf{p}) \phi_{\alpha_i}(\mathbf{p})
\end{align}
Note that we also could have derived this result by instead of inserting the unit $\prod_{i=1}^{A} \textrm{d}^{3} \mathbf{p}_{i} \ket{\mathbf{p}_{i}}\bra{\mathbf{p}_{i}}$ we expand $\ket{\Phi}$ in terms of single particle creation operators,
\begin{align}
	a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} \ket{\Phi} &= a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} \ket{ \alpha_1 \alpha_2 \ldots \alpha_A } = a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \ldots a_{\alpha_A}^{\dagger} \ket{0}
\end{align}
The commutation relations between $a_{\mathbf{p}}$ and $a_{\alpha_i}$ are easily derived by expanding $a_{\alpha_i}$ in momentum creation operators,
\begin{align}
	a_{\alpha_i}^{\dagger} &= \int \textrm{d}^{3} \mathbf{k} \phi_{\alpha_i}(\mathbf{k}) a_{k}^{\dagger} \\
	\Rightarrow a_{\mathbf{p}} a_{\alpha_i}^{\dagger} &= \int \textrm{d}^{3} \mathbf{k} \phi_{\alpha_i}(\mathbf{k}) a_{\mathbf{p}} a_{\mathbf{k}}^{\dagger} = \phi_{\alpha_i}(\mathbf{p}) - a_{\alpha_i}^{\dagger} a_{\mathbf{p}}
\end{align}
So,
\begin{align}
	a_{\mathbf{p}} \ket{\Phi} &= a_{\mathbf{p}} a_{\alpha_1}^{\dagger} a_{\alpha_2}^{\dagger} \ldots a_{\alpha_A}^{\dagger} \ket{0} = (\phi_{\alpha_1}(\mathbf{p}) - a_{\alpha_1}^{\dagger} a_{\mathbf{p}}) a_{\alpha_2}^{\dagger} \ldots a_{\alpha_A}^{\dagger} \ket{0} \\
	&= \sum_{i=1}^{A} (-1)^{i-1} \phi_{\alpha_{i}}(\mathbf{p}) \ket{ \alpha_1 \ldots \alpha_{i-1} \alpha_{i+1} \ldots \alpha_A}
\end{align}
The conjugate gives,
\begin{align}
	\bra{\Phi} a_{\mathbf{p}}^{\dagger} &= \sum_{j=1}^{A} (-1)^{j-1} \bra{ \alpha_1 \ldots \alpha_{j-1} \alpha_{j+1} \ldots \alpha_A} \phi_{\alpha_j}^{\dagger}(\mathbf{p})
\end{align}
Hence,
\begin{align}
\braket{ \Phi | a_{\mathbf{p}}^{\dagger} a_{\mathbf{p}} | \Phi} &= \sum_{i,j=1}^{A} (-1)^{i+j} \phi_{\alpha_j}^{\dagger}(\mathbf{p}) \phi_{\alpha_{i}}(\mathbf{p})  \underbrace{\braket{ \alpha_1 \ldots \alpha_{j-1} \alpha_{j+1} \ldots \alpha_A | \alpha_1 \ldots \alpha_{i-1} \alpha_{i+1} \ldots \alpha_A }}_{=\delta_{ij}} \\
	&= \sum_{i} \phi_{\alpha_i}^{\dagger}(\mathbf{p}) \phi_{\alpha_{i}}(\mathbf{p})
\end{align}
Which is exactly the same result as before.



So the one body momentum distribution is given by,
\begin{align}
	\braket{ \Phi | \hat{n}(p) | \Phi} &=  \sum_{i=1}^{A} \frac{1}{(2 \pi)^{3}} \int \textrm{d}^{2} \Omega_{\mathbf{p}}\phi_{\alpha_i}^{\dagger}(\mathbf{p}) \phi_{\alpha_i}(\mathbf{p})
\end{align}
Note that this distribution is normed to the number of particles $A$. To get the momentum distribution normed to unity we have to divide by A,
\begin{align}
	\braket{ \Phi | \hat{n}(p) | \Phi} &=  \frac{1}{A} \sum_{i=1}^{A} \frac{1}{(2 \pi)^{3}} \int \textrm{d}^{2} \Omega_{\mathbf{p}}\phi_{\alpha_i}^{\dagger}(\mathbf{p}) \phi_{\alpha_i}(\mathbf{p})
\end{align}

\section{Nucleus}
\subsection{shell.h}
This class contains the quantum number of a shell $nlj$. It has two (proton \& neutron) static arrays containing all the shells.
\begin{verbatim}
	shellsN = [ Shell(n1,l1,j1), Shell(n2,l2,j2), ... ]
	shellsP = [ Shell(n1,l1,j1), Shell(n2,l2,j2), ... ]
\end{verbatim}
These two arrays are initialised and deleted by the static methods \texttt{Shell::initialiseShells}, \texttt{Shell::deleteShells}.

\subsection{nucleus.h}
First important method here is \texttt{Nucleus::makePairs}. Note that this relies on overloaded virtual functions to function. It iterates over the quantum numbers, $n_1 l_1 j_1 m_{j_1}, n_2 l_2 j_2 m_{j_2}$ and makes a pair for each of these combinations: \texttt{Pair::Pair(mosh,n1,l1,j1,mj1,t1,n2,l2,j2,mj2,t2)}. \texttt{mosh} is the return value of \texttt{RecMosh::createRecMosh(n1,l1,n2,l2,inputdir,outputdir)}, being a \texttt{RecMosh} object. The moshinsky brackets $\braket{n_1 l_1 n_2 l_2; \Lambda | n l N L ; \Lambda}$ can be accessed by calling \texttt{RecMosh::getCoefficient(n,l,N,L,Lambda)}.
Open shells are taken care of by calculating a open shell correction factor and applying it to the pair via \texttt{Pair::setfnorm(factor)}.

Once the pairs (\texttt{Pair::Pair}) are generated we can generate a 



\section{Pair coupling}
\subsection{pair.h}
This class represents the state
\begin{align}
	\ket{ \alpha_1, \alpha_2}_{\textrm{nas}} \;\;\;, \ket{\alpha} \equiv \ket{n l j m_j t m_t}
\end{align}
The class calculates all the coefficients,
\begin{align}
	C_{\alpha_1 \alpha_2}^{A} = \braket{A \equiv \{ n l S j m_j, N L M_L T M_T\} | \alpha_1 \alpha_2}_{\text{nas}}
	\label{eq:coef}
\end{align}
The main method here is \texttt{Pair::makecoeflist()}. It loops over all possible values of $ A \equiv \{ S,T,n,l,N,M_L,j,m_j \}$. Where in the summation over $\{n,l,N,L\}$ the energy conservation $2n_1 + l_1 + 2n_2 + l_2 = 2n + l + 2N + L$ is taken into account to eliminate one of the summation loops, $L = 2n_1 + l_1 + 2n_2 + l_2 - 2n - l - 2N$. Note that $M_T$ is also fixed by $M_T = m_{t_1} + m_{t_2}$ and no summation over this is performed, as we want to keep the contribution from different pairs seperated.
For each $A$ a new object \texttt{Newcoef} is generated and stored in the member \texttt{std::vector<NewCoef*> coeflist}.
\subsection{newcoef.h}
This class takes the parameters $n_1 l_1 j_1 m_{j_1} m_{t_1} n_2 l_2 j_2 m_{j_2} m_{t_2} N L M_L n l S j m_j T M_T$, and calculates the coefficient given in Eq. (\ref{eq:coef}). It takes also a pointer to a \texttt{RecMosh} object that holds the Moshinsky brakets. The only function in this class is to calculate $C_{\alpha_1 \alpha_2}^{A}$ using the formula,
\begin{multline}
	\sum_{J M_J} \sum_{\Lambda} 
	[ 1 - (-1)^{L+S+T}] \braket{ t_1 m_{t_1} t_2 m_{t_2} | T M_T }
	\braket{ j_1 m_{j_1} j_2 m_{j_2} | J M_J}
	\braket{ j m_j L M_L | J M_J } \\
	\braket{ n l N L; \Lambda | n_1 l_1 n_2 l_2 ; \Lambda}_{\textrm{SMB}}
	\sqrt{2 \Lambda + 1} \sqrt{ 2j+1}
	\left\{
	\begin{array}{ccc}
		j & L & J \\
		\Lambda & S & l
	\end{array}
	\right\} \\
	\sqrt{2j_1 + 1} \sqrt{2j_2 + 1} \sqrt{ 2S + 1} \sqrt{ 2 \Lambda + 1}
	\left\{
	\begin{array}{ccc}
		l_1 & s_1 & j_1 \\
		l_2 & s_2 & j_2 \\
		\Lambda & S & J \\
	\end{array}
	\right\}
\end{multline}
It is easy to check that the result indeed depends on $\alpha_1, \alpha_2, A$. Note that it is always assumed that $s_i,t_i \equiv \frac{1}{2}$ as we are dealing with protons and neutrons.
This class also defines a \texttt{``key''} to be able to index the coefficients, \texttt{key = ``nlSjm\_j.NLM\_L.TM\_T''}.

\subsection{paircoef.h}
This is a very thin class designed to do some bookkeeping. As outlined in Maartens thesis pg 156, different $\ket{\alpha_1 \alpha_2}$ combinations will sometimes map to the same ``rcm'' states $A = \ket{ nlSjm_j NLM_L TM_T}$. In matrix element calculations,
\begin{align}
	\braket{\alpha_1 \alpha_2 | \hat{\mathcal{O}} | \alpha_1 \alpha_2} = \sum_{AB} C_{\alpha_1 \alpha_2}^{A \dagger} C_{\alpha_1 \alpha_2}^{B} \braket {A | \hat{\mathcal{O}} | B }
	\label{eq:rcm_nonzerodiag}
\end{align}
We want to calculate matrix elements as $\braket{ A | \hat{\mathcal{O}} | B}$ only once. $\ket{\alpha_1 \alpha_2}$ that map to the same $A,B$ states should lookup the earlier calculated values for $\braket{ A | \hat{\mathcal{O}} | B}$.
In general the matrix element $\braket{ A | \hat{\mathcal{O}} | B }$ is not diagonal. 
A \texttt{Paircoef} object has all the quantum numbers in a rcm state $A$. In addition it holds a value and a map \texttt{ std::map<Paircoef*, double>}. The map is used to link a rcm state $\ket{A}$ to all other rcm states $\ket{B}$ which yield a non zero contribution for $\braket{ A | \hat{\mathcal{O}} | B }$. The value for the transformation coefficients $C_{\alpha_1,\alpha_2}^{A,\dagger} C_{\alpha_1,\alpha_2}^{B}$ is stored in the second field of the map (\texttt{double}). So that the the summation over $B$ (Eq. \ref{eq:rcm_nonzerodiag}) is replaced by,
\begin{align}
	\braket{\alpha_1 \alpha_2 | \hat{\mathcal{O}} | \alpha_1 \alpha_2} = \sum_{A} \sum_{\texttt{Paircoef(A).links}}  \texttt{link.strength} \braket {A | \hat{\mathcal{O}} | B }
\end{align}
\todo[inline]{\texttt{Paircoef::add(double val)} adds \texttt{val} to private member \texttt{value} but as far as I can see this private member \texttt{value} is NEVER used!}

\section{Matrix Elements}
First some theory on the matrix elements. In the calculation of the norm we only have the correlation operator $\hat{\wr}$ between the bras and kets.
\begin{align*}
	\braket{ \alpha \beta |\hat{\wr}(\vec{x}_{1},\vec{x}_{2}) + \hat{\wr}^{\dagger}(\vec{x}_{1},\vec{x}_{2}) + \hat{\wr}^{\dagger}(\vec{x}_{1},\vec{x}_{2})\hat{\wr}(\vec{x}_{1},\vec{x}_{2}) | \alpha \beta}
\end{align*}
$\hat{\wr}$ contains a central, tensor and spin-isospin part,
\begin{align*}
	\hat{\wr}(\vec{x}_{1},\vec{x}_{2}) = -f_c(r_{12}) + f_{t\tau}(r_{12}) \hat{S}_{12} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} + f_{\sigma \tau}(r_{12}) \hat{ \vec{\sigma}}_{1} \cdot \hat{ \vec{\sigma}}_{2} \hat{ \vec{\tau}}_{1} \cdot \hat{ \vec{\tau}}_{2}  \, .
\end{align*}
Transforming to the c.m. and relative coordinates a general matrix-element term can be written as,
\begin{align*}
	\braket{ n (l S) j m_j N L M_L T M_T |  \hat{\mathcal{O}}^{p\dagger} f^{\dagger}_{p} f_{q} \hat{\mathcal{O}}^{q} | n' (l' S') j' m_j' N' L' M_L' T' M_T'} 
\end{align*}
With $f_{p,q} \in \{ 1, f_{c}, f_{t\tau}, f_{\sigma \tau} \}$ and $\hat{\mathcal{O}}^{p,q}$ the corresponding operator $\in \{ \mathbb{1}, \mathbb{1},  \hat{S}_{12} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2}, \hat{ \vec{\sigma}}_{1} \cdot \hat{ \vec{\sigma}}_{2} \hat{ \vec{\tau}}_{1} \cdot \hat{ \vec{\tau}}_{2} \} $.
As no operators act on the c.m. part $ \ket{ N L M_L}$ here we have,
\begin{align*}
	\delta_{NN'} \delta_{LL'} \delta_{M_L M_L'} \braket{ n (l S) j m_j T M_T |  \hat{\mathcal{O}}^{p\dagger} f^{\dagger}_{p} f_{q} \hat{\mathcal{O}}^{q} | n' (l' S') j' m_j' T' M_T'}  
\end{align*}
Let us now take a look at the separate cases for $\delta_{NN'} \delta_{LL'} \delta_{M_L M_L'} \braket{ n (l S) j m_j T M_T |  \hat{\mathcal{O}}^{p\dagger} f^{\dagger}_{p} f_{q} \hat{\mathcal{O}}^{q} | n' (l' S') j' m_j' T' M_T'} $,
\begin{itemize}
	\item $\hat{\mathcal{O}}^{p} = \mathbb{1}$, $f_{p} = 1$, $\hat{\mathcal{O}}^{q} = \mathbb{1}$ , $f_{q} = f_c(r_{12})$ 
	\begin{multline*}
		\delta_{NN'} \delta_{LL'} \delta_{M_L M_L'} \braket{ n (l S) j m_j T M_T |  f_{c}(r_{12}) | n' (l' S') j' m_j' T' M_T'}  \\
		= \delta_{NN'} \delta_{LL'} \delta_{M_L M_L'} \delta_{SS'} \delta_{jj'} \delta_{m_j m_j'} \delta_{TT'} \delta_{M_T M_T'} \delta_{l l'} \braket{ n l |  f_{c}(r_{12}) | n' l'} 
	\end{multline*}
	\begin{multline*}
		\braket{ n l |  f_{c}(r_{12}) | n' l'} = \int \text{d} r_{12} \, r_{12}^{2} R_{nl}(r_{12}) f_{c}(r_{12}) R_{n'l'}(r_{12}) \\
	\end{multline*}
	With  $R_{nl}(r) = \left[ \frac{2n!}{\Gamma(n + l + 3/2)} \nu^{l + 3/2} \right]^{\frac{1}{2}} r^{l} e^{-\nu r^{2} /2} L_{n}^{l+1/2}(\nu r^{2}) = N_{nl} \nu^{\frac{l + 3/2}{2}} r^{l} e^{-\nu r^{2} /2} L_{n}^{l+1/2}(\nu r^{2})$ and $ \nu = M_N \omega / \hbar $.
	\begin{multline*}
		\braket{ n l |  f_{c}(r_{12}) | n' l'} = N_{nl} N_{n'l'} \nu^{\frac{l + l' + 3}{2}} \int \text{d} r_{12} \, r_{12}^{2} r_{12}^{l} e^{-\nu r_{12}^{2} /2} L_{n}^{l+1/2}(\nu r_{12}^{2}) f_{c}(r_{12}) r_{12}^{l'} e^{-\nu r_{12}^{2} /2} L_{n'}^{l'+1/2}(\nu r_{12}^{2}) \\
	\end{multline*}
	The correlation functions $f_{p}(r)$ are expanded as $ \sum_{\lambda} b_{\lambda} r^{\lambda} e^{-b r^{2}}$, expanding the generalized laguerre polynomials as well, $ L_{n}^{l}(r) = \sum_{k} a_{nl,k} r^{k}$,
	\begin{multline*}
		\braket{ n l |  f_{c}(r_{12}) | n' l'} = N_{nl} N_{n'l'} \nu^{\frac{l + l' + 3}{2}} \sum_{kk'\lambda} a_{nl,k} a_{n'l',k'} b_{\lambda}  \int \text{d} r_{12} r_{12}^{2+l+l'} e^{-\nu r_{12}^{2}} ( \nu r_{12}^{2} )^{k} r_{12}^{\lambda} e^{-b r_{12}^{2}} ( \nu r_{12}^{2})^{k'}
	\end{multline*}
	With the substitution $r = \sqrt{\nu} \, r_{12}, B = b/\nu$ (units are $[\nu] = \text{m}^{-2}, [b] = \text{m}^{-2}, [r] = 1, [B] = 1$) we get,
	\todo[inline]{Maarten says $B = b/\sqrt{\nu}$ (D.19), I think this is incorrect (units do not match), $Bx^{2}$ of (D.19) is NOT dimensionless while it should be... (appears to be correct in the code however...)}
	\begin{multline}
		\braket{ n l |  f_{c}(r_{12}) | n' l'} = N_{nl} N_{n'l'} \nu^{\frac{l + l' + 3}{2}} \sum_{kk'\lambda} a_{nl,k} a_{n'l',k'} b_{\lambda}  \nu^{- \frac{3 + l + l' + \lambda}{2}} \int \text{d} r \, r^{2+l+l'} e^{-r^{2}} r^{2k} r^{\lambda} e^{-B r^{2}} r^{2k'} \\
		= N_{nl} N_{n'l'} \sum_{kk'\lambda} \nu^{-\frac{\lambda}{2}}  a_{nl,k} a_{n'l',k'} b_{\lambda} \int \text{d} r \, r^{2+l+l'+\lambda + 2k + 2k'} e^{-(B+1) r^{2}} \\
		=  N_{nl} N_{n'l'}  \sum_{kk'\lambda} \nu^{-\frac{\lambda}{2}} a_{nl,k} a_{n'l',k'} b_{\lambda} \frac{1}{2} \Gamma \left( \frac{K+1}{2} \right) (1 + B)^{-\frac{K+1}{2}} \\
		= \frac{N_{nl} N_{n'l'}}{2}  \sum_{kk'\lambda} \nu^{-\frac{\lambda}{2}} a_{nl,k} a_{n'l',k'} b_{\lambda} \Gamma \left( \frac{K+1}{2} \right) (1 + B)^{-\frac{K+1}{2}}
		\label{eq:central_corr_single}
	\end{multline}
	$K = 2+l+l'+ \lambda + 2k + 2k'$. To recapitulate, $a_{nl,k}$ is the $k$'th expansion coefficient of the Laguerre polynomials. The sum over $k$ ($k'$) ranges from $0$ to $n$ ($n'$). $b_{\lambda}$ is the $\lambda$'th expansion coefficient of the correlation function, runs from $0$ to a finite value ($10$ or $11$ for Maartens' fits). $\nu = M_N \omega /\hbar$ is the H.O.-potential parameter and is nucleus dependent. $N_{nl} = \left[ \frac{2n!}{\Gamma(n + l + 3/2)} \right]^{\frac{1}{2}} = \left[ \frac{ 2 \, \Gamma( n + 1)}{\Gamma(n + l + 3/2)} \right]^{\frac{1}{2}} $ are the normalisation factors of the orbital wave functions, these factors are nucleus independent (only $n,l$ dependencies).

	Orthonormality using this expansion (Eq.~\ref{eq:central_corr_single}) can easily be checked, $\braket{ n l |  1 | n' l}$ ($l=l'$ because of the orthonormality of the spherical harmonics), if we set $b_{\lambda} = \delta_{\lambda,0}$, $b=0$.
	\begin{align}
		\braket{ n l |  1 | n' l} =  \frac{N_{nl} N_{n'l}}{2}  \sum_{kk'=0}^{nn'} a_{nl,k} a_{n'l,k'} \Gamma \left( \frac{3+2l+2k + 2k'}{2} \right)
	\end{align}
	\item $\hat{\mathcal{O}}^{p} = \mathbb{1}$, $f_{p} = f_c(r_{12})$, $\hat{\mathcal{O}}^{q} = \mathbb{1}$ , $f_{q} = f_c(r_{12})$, the non trivial part of the matrix element now comes down to calculating,
	\begin{multline*}
		\braket{ n l |  f_{c}^{2}(r_{12}) | n' l'} = \int \text{d} r_{12} \, r_{12}^{2} R_{nl}(r_{12}) f_{c}^{2}(r_{12}) R_{n'l'}(r_{12}) \\
		= N_{nl} N_{n'l'} \nu^{\frac{l + l' + 3}{2}} \sum_{kk'\lambda \lambda'} a_{nl,k} a_{n'l',k'} b_{\lambda} b_{\lambda'}  \int \text{d} r_{12} r_{12}^{2+l+l'} e^{-\nu r_{12}^{2}} ( \nu r_{12}^{2} )^{k} r_{12}^{\lambda+\lambda'} e^{-2 b r_{12}^{2}} ( \nu r_{12}^{2})^{k'} \\
		= N_{nl} N_{n'l'} \nu^{\frac{l + l' + 3}{2}} \sum_{kk'\lambda \lambda'} a_{nl,k} a_{n'l',k'} b_{\lambda} b_{\lambda'} \nu^{- \frac{3 + l + l' + \lambda + \lambda'}{2}} \int \text{d} r \, r^{2+l+l'+2k+2k'+\lambda + \lambda'} e^{- ( 2B + 1) r^{2}} \\
		=  \frac{N_{nl} N_{n'l'}}{2} \sum_{kk'\lambda \lambda'} \nu^{ - \frac{\lambda + \lambda'}{2}} a_{nl,k} a_{n'l',k'} b_{\lambda} b_{\lambda'} \Gamma\left(\frac{K+1}{2}\right) (2B+1)^{-\frac{K+1}{2}}
	\end{multline*}
	With $K = 2+l+l'+2k+2k'+\lambda+\lambda'$.
\end{itemize}
\section{Matrix elements bis}

Let us take a look at
\begin{align*}
	\braket{ S | \hat{ \vec{\sigma}}_{1} \cdot \hat{ \vec{\sigma}}_{2} | S'} = 4 \braket{ S | \hat{ \vec{s}}_{1} \cdot \hat{ \vec{s}}_{2} | S'} = 4 \braket{ S | \hat{\vec{S}}^{\, 2} - \hat{\vec{s}}_{1}^{\,2} - \hat{\vec{s}}_{2}^{\,2} | S'} = 2 ( S(S+1) - \frac{3}{4} - \frac{3}{4} ) \delta_{SS'} = \delta_{SS'} (2 S(S+1) - 3)
\end{align*}
As we have 2 spin $1/2$ particles S can be either $0,1$ resulting in $\braket{ 1 | \hat{ \vec{\sigma}}_{1} \cdot \hat{ \vec{\sigma}}_{2} | 1} = 1$, $\braket{ 0 | \hat{ \vec{\sigma}}_{1} \cdot \hat{ \vec{\sigma}}_{2} | 0} = -3$.
\todo[inline]{ Note that in the Maartens code the expression is modified to $4S-3$, which is equivalent for $S \in \{0,1\} $.} As this is independent of the spin projection $M_S$ we have,
\begin{align*}
	\braket{ S M_S | \hat{ \vec{\sigma}}_{1} \cdot \hat{ \vec{\sigma}}_{2} | S' M_S'} = \delta_{SS'} \delta_{M_S M_S'} (2 S(S+1) - 3)
\end{align*}
Exactly the same derivation can be made for $\hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2}$ leading to the same result.
\begin{align*}
	\braket{ T M_T | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | T' M_T'} = \delta_{TT'} \delta_{M_T M_T'} (2 T(T+1) - 3)
\end{align*}
When selecting a a specific isospin projection $m_t = \pm 1/2 $ (proton or neutron) of a nucleon this result changes however.
The product $\hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2}$ written in the spherical basis becomes,
\begin{align*}
	\hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} = \hat{\tau}_{1,0} \hat{\tau}_{2,0} - \hat{\tau}_{1,+} \hat{\tau}_{2,-} - \hat{\tau}_{1,-} \hat{\tau}_{2,+} = \hat{\tau}_{1,0} \hat{\tau}_{2,0} + \frac{\hat{\tau}_{1}^{+} \hat{\tau}_{2}^{-}}{2} + \frac{ \hat{\tau}_{1}^{-} \hat{\tau}_{2}^{+}}{2}
\end{align*}
Where $\hat{\tau}^{\pm}$ are the raising/lowering operators. Transitioning to the operators $\hat{t} = \hat{\tau}/2$ (analogues to the spin case $\hat{S} = \hat{\sigma}/2$) with the properties,
\begin{align*}
\hat{t}_0 \ket{ t, m_t} &= m_t \ket{ t, m_t} \\
\hat{t}^{\pm} \ket{ t, m_t} &= \sqrt{ t(t+1) - m(m \pm 1)} \ket { t, m_t \pm 1}.
\end{align*}
we get
\begin{align*}
	\hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} = 4 \hat{t}_{1,0} \hat{t}_{2,0} + 2 \hat{t}_{1}^{+} \hat{t}_{2}^{-} + 2 \hat{t}_{1}^{-} \hat{t}_{2}^{+} 
\end{align*}

Defining the isospin-projection operator acting on particle ``$i$'' of the nucleon pair $ \hat{\delta}_{m_t}^{[1]} = ( 1 + (2 m_t) \hat{t}_{i,0})/2$ we get,
\begin{multicols}{2}
\noindent
\begin{align*}
	\hat{\delta}_{m_t}^{[1]} \ket{ 1, \pm 1} &= \delta_{\pm 1,2m_t}  \ket{ 1, \pm 1}  \\
	\hat{\delta}_{m_t}^{[1]} \ket{ 1,0} &= \frac{1}{\sqrt{2}} \ket{ \frac{1}{2}, m_t} \otimes \ket{ \frac{1}{2}, -m_t} \\
	\hat{\delta}_{m_t}^{[1]} \ket{ 0,0} &= \frac{1}{\sqrt{2}} 2 m_t \ket{ \frac{1}{2}, m_t} \otimes \ket{ \frac{1}{2}, -m_t}
\end{align*}
\begin{align*}
	\hat{\delta}_{m_t}^{[2]} \ket{ 1, \pm 1} &= \delta_{\pm 1,2m_t}  \ket{ 1, \pm 1}  \\
	\hat{\delta}_{m_t}^{[2]} \ket{ 1,0} &= \frac{1}{\sqrt{2}} \ket{ \frac{1}{2}, -m_t} \otimes \ket{ \frac{1}{2}, m_t} \\
	\hat{\delta}_{m_t}^{[2]} \ket{ 0,0} &= \frac{1}{\sqrt{2}} (-2 m_t) \ket{ \frac{1}{2}, m_t} \otimes \ket{ \frac{1}{2}, -m_t}
\end{align*}
\end{multicols}
Note that sgn$(m_t) \equiv 2m_t$ as $m_t = \pm 1/2$.
It is straightforward to show that,
\begin{multicols}{2}
\noindent
\begin{align*}
	\braket{ 1, \pm 1 | \hat{\delta}_{m_t}^{[1]} | 1, \pm 1} &= \delta_{\pm 1,2m_t}  \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[1]} | 1,0} = \braket{ 0,0 | \hat{\delta}_{m_t}^{[1]} | 0,0} &=  \frac{1}{2} \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[1]} | 0,0} = \braket{ 0,0 | \hat{\delta}_{m_t}^{[1]} | 1,0} &=  \frac{1}{2} 2 m_t
\end{align*}
\begin{align*}
	\braket{ 1, \pm 1 | \hat{\delta}_{m_t}^{[2]} | 1, \pm 1} &= \delta_{\pm 1,2m_t}  \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[2]} | 1,0} = \braket{ 0,0 | \hat{\delta}_{m_t}^{[1]} | 0,0} &=  \frac{1}{2} \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[2]} | 0,0} = \braket{ 0,0 | \hat{\delta}_{m_t}^{[1]} | 1,0} &=  \frac{1}{2} (-2 m_t) 
\end{align*}
\end{multicols}
We now investigate the effect of the insertion of the isospin-projection operator $\hat{\delta}_{m_t}^{[i]}$ in 
\begin{align*}
	\braket{ T M_T | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | T' M_T'}
\end{align*}
Note that $\hat{\delta}_{m_t}^{[i]}$ and $ \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2}$ are hermitian but do not commute. Hence the operator $\hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[i]}$ is \textbf{not hermitian}.
\begin{align*}
	\hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} \ket { 1, \pm 1 } = \delta_{ \pm 1,2 m_t} \ket{ 1, \pm 1 }
\end{align*}
\begin{multline*}
	\hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} \ket { 1, 0 } = \frac{1}{\sqrt{2}} \Big( - \ket{ \frac{1}{2}, m_t} \otimes \ket{ \frac{1}{2}, -m_t} \\
	 + (1-2m_t) \ket{ \frac{1}{2}, m_t + 1} \otimes \ket{ \frac{1}{2},- m_t - 1} \\
	+  (1+2m_t) \ket{ \frac{1}{2}, m_t -1 } \otimes \ket{ \frac{1}{2}, -m_t + 1} \Big) \\
\end{multline*}
\begin{multline*}
	\hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} \ket { 0, 0 } = \frac{1}{\sqrt{2}} \Big( - 2m_t \ket{ \frac{1}{2}, m_t} \otimes \ket{ \frac{1}{2}, -m_t} \\
	 + (2m_t-1) \ket{ \frac{1}{2}, m_t + 1} \otimes \ket{ \frac{1}{2},- m_t - 1} \\
	+  (2m_t+1) \ket{ \frac{1}{2}, m_t -1 } \otimes \ket{ \frac{1}{2}, -m_t + 1} \Big) \\
\end{multline*}
The non-zero matrix elements for $ \braket{ T M_T | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[i]} | T' M_T'}$ are (one can make use of the fact that both $\hat{\delta}_{m_t}^{[i]}$ and $ \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2}$ are hermitian and let them act on the neighbouring bra or ket),
\begin{multicols}{2}
\noindent
\begin{align*}
	\braket{ 1, \pm 1 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} | 1, \pm 1} &= \delta_{ \pm 1,2m_t}  \\
	\braket{ 1,0 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} | 1,0} &= \frac{1}{2} \\
	\braket{ 1,0 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} | 0,0} &= \frac{1}{2}2m_t \\
	\braket{ 0,0 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} | 1,0} &=-\frac{3}{2}2m_t \\
	\braket{ 0,0 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} | 0,0} &=-\frac{3}{2}
\end{align*}
\begin{align*}
	\braket{ 1, \pm 1 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]} | 1, \pm 1} &= \delta_{ \pm 1,2m_t}  \\
	\braket{ 1,0 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]} | 1,0} &= \frac{1}{2} \\
	\braket{ 1,0 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]} | 0,0} &=-\frac{1}{2}2m_t \\
	\braket{ 0,0 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]} | 1,0} &= \frac{3}{2}2m_t \\
	\braket{ 0,0 | \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]} | 0,0} &=-\frac{3}{2}
\end{align*}
\end{multicols}
The non-zero matrix elements for $ \braket{ T M_T |  \hat{\delta}_{m_t}^{[i]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | T' M_T'}$ are,
\begin{multicols}{2}
\noindent
\begin{align*}
	\braket{ 1, \pm 1 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 1, \pm 1} &= \delta_{ \pm 1,2m_t}  \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 1,0} &= \frac{1}{2} \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 0,0} &=-\frac{3}{2} 2m_t \\
	\braket{ 0,0 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 1,0} &= \frac{1}{2} 2m_t \\
	\braket{ 0,0 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 0,0} &=-\frac{3}{2}
\end{align*}
\begin{align*}
	\braket{ 1, \pm 1 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 1, \pm 1} &= \delta_{ \pm 1,2m_t}  \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 1,0} &= \frac{1}{2} \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 0,0} &= \frac{3}{2} 2m_t \\
	\braket{ 0,0 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 1,0} &=-\frac{1}{2} 2m_t \\
	\braket{ 0,0 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} | 0,0} &=-\frac{3}{2}
\end{align*}
\end{multicols}

The non-zero matrix elements for $ \braket{ T M_T |  \hat{\delta}_{m_t}^{[i]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[i]} | T' M_T'}$ are,
\begin{align*}
	\braket{ 1, \pm 1 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} | 1, \pm 1} &= \braket{ 1, \pm 1 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]} | 1, \pm 1} = \delta_{ \pm 1,2m_t}  \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} | 1,0} &= \braket{ 0,0 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]}| 0,0} = -\frac{1}{2} \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]} | 0,0} &= \braket{ 0,0 | \hat{\delta}_{m_t}^{[1]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[1]}| 1,0}=-\frac{1}{2} 2m_t \\
		\braket{ 1,0 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]} | 1,0} &= \braket{ 0,0 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]}| 0,0} = -\frac{1}{2} \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]} | 0,0} &= \braket{ 0,0 | \hat{\delta}_{m_t}^{[2]} \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{m_t}^{[2]}| 1,0}=\frac{1}{2} 2m_t
\end{align*}
Note that the combinations of different isospin-projections are not necessarily zero when the operator $ \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2}$ is involved,
\begin{multicols}{2}
\noindent
\begin{align*}
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[1]}  \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{-m_t}^{[1]} | 1,0 } &= 1 \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[1]}  \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{-m_t}^{[1]} | 0,0 } &= -2m_t \\
	\braket{ 0,0 | \hat{\delta}_{m_t}^{[1]}  \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{-m_t}^{[1]} | 1,0 } &= 2m_t \\
	\braket{ 0,0 | \hat{\delta}_{m_t}^{[1]}  \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{-m_t}^{[1]} | 0,0 } &= -1
\end{align*}
\begin{align*}
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[2]}  \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{-m_t}^{[2]} | 1,0 } &= 1 \\
	\braket{ 1,0 | \hat{\delta}_{m_t}^{[2]}  \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{-m_t}^{[2]} | 0,0 } &= 2m_t \\
	\braket{ 0,0 | \hat{\delta}_{m_t}^{[2]}  \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{-m_t}^{[2]} | 1,0 } &=-2m_t \\
	\braket{ 0,0 | \hat{\delta}_{m_t}^{[2]}  \hat{\vec{\tau}}_{1} \cdot \hat{\vec{\tau}}_{2} \hat{\delta}_{-m_t}^{[2]} | 0,0 } &= -1
\end{align*}
\end{multicols}
These matrix element have been checked with a simple python program (\texttt{numpy.kron} ftw for kronecker products). Note that all the matrix elements for $i=1,2$ are the same expect for a minus sign whenever a combination like $ \braket{ 1,0 | \ldots | 0,0}$ or $\braket{0,0| \ldots | 1,0}$ is involved.
Also note that all the matrix elements do not mix different $M_T, M_T'$, so we effectively have $\delta_{M_T M_T'}$ everywhere.
\subsection{norm\_ob : public operator\_virtual\_ob}
Here we take a look at the calculation of the norm $\mathcal{N}$ in \texttt{norm\_ob.cpp}.
Note that this class inherits from \texttt{operator\_virtual\_ob}, declaring general one body member functions.
\begin{itemize}
	\item \texttt{norm\_ob::get\_me( Pair )}.
		This calculates the matrix element \textbf{meanfield} matrix element sum 
		\begin{enumerate}
		\item $\frac{2}{A} \sum_{ A B } C_{\alpha_1 \alpha_2}^{A \dagger} C_{\alpha_1 \alpha_2}^{B} \braket {A | B }$ for a pp and/or nn pair(s) (isospin $M_T = \pm 1$)
		\item $\frac{1}{A} \sum_{ A B} C_{\alpha_1 \alpha_2}^{A \dagger} C_{\alpha_1 \alpha_2}^{B} \braket {A | B }$ for a pn pair (isospin $M_T = 0$)
	\end{enumerate}
	for a specific pair $\alpha_1 \alpha_2$ passed trough \texttt{Pair}.
	\todo[inline]{For now I have no clue why/how the factor $\frac{2}{A}$($\frac{1}{A}$) in front of $\sum_{ A B } C_{\alpha_1 \alpha_2}^{A \dagger} C_{\alpha_1 \alpha_2}^{B} \braket {A | B }$ ...}		
		It is possible to filter on relative quantum numbers on $n_A,l_A,n_B,l_B$, selecting specific contributions \texttt{nAs,lAs,nBs,lBs} to the sum. A value of $-1$ for these variables is interpreted as ``all values allowed''. Trough the braket $\braket{ A | B }$ we already have $n_A = n_B := n$, $l_A = l_B := l$.
		\begin{itemize}
			\item \texttt{if (nAs > -1 \&\& nBs > -1)}
				This forces $\texttt{nAs} = \texttt{nBs} = n$. So for $\texttt{nAs} \neq \texttt{nBs}$ we will get $0$.
			\item \texttt{if (nAs == -1 \&\& nBs > -1)}
				This forces $\texttt{nBs} = n$. Selecting a specific $n = n_A = n_B$ contribution.
			\item \texttt{if (nAs > -1 \&\& nBs == -1)}
				This forces $\texttt{nAs} = n$. Selecting a specific $n = n_A = n_B$ contribution.
			\item \texttt{if (nAs == -1 \&\& nBs == -1)}
				This makes no restrictions on $n = n_A = n_B$.
		\end{itemize}
		The exact same is valid for $l = l_A = l_B$ and \texttt{lAs},\texttt{lBs}.
		A few examples (\texttt{nAs,lAs,nBs,lBs}):
		\begin{itemize}
			\item (\texttt{-1, 2,-1,-1}) : allow all $n = n_A = n_B$ values. Restriction on $l = l_A = l_B = \texttt{2}$.
			\item (\texttt{-1, 2,-1, 2}) : allow all $n = n_A = n_B$ values. Restriction on $l = l_A = l_B = \texttt{2}$.
		\end{itemize}
	As the unrestricted sum $\sum_{ A B } C_{\alpha_1 \alpha_2}^{A \dagger} C_{\alpha_1 \alpha_2}^{B} \braket {A | B } = \sum_{A} | C^{A}_{\alpha_1 \alpha_2}|^{2} $ equals 1, the return value of \texttt{get\_me} (for the unrestricted sum) is,
	\begin{itemize}
		\item $\frac{2}{A}$ with no restriction on the isospin ( \texttt{norm\_ob::norm\_ob\_params.t = 0})
		\item $\frac{2}{A}$ for pp-pairs, $\frac{1}{A}$ for pn-pairs and $0$ for nn-pairs for a proton (\texttt{norm\_ob::norm\_ob\_params.t~=~1})
		\item $0$ for pp-pairs, $\frac{1}{A}$ for pn-pairs and $\frac{2}{A}$ for nn-pairs for a neutron (\texttt{norm\_ob::norm\_ob\_params.t~=-1})
	\end{itemize}
	If we sum over all the pairs $ \sum_{\texttt{pair in pairs}} $ \texttt{norm::ob\_get\_me(pair,...)} we get,
	\begin{itemize}
		\item $\frac{A(A-1)}{2} \frac{2}{A} = A-1$ with no restriction on the isospin ( \texttt{norm\_ob::norm\_ob\_params.t~=~0})
		\item $\frac{Z(Z-1)}{2}\frac{2}{A} + NZ \frac{1}{A} + \frac{N(N-1)}{2} 0 = Z \frac{A-1}{A}$ for a proton (\texttt{norm\_ob::norm\_ob\_params.t~=~1})
		\item $\frac{Z(Z-1)}{2}0 + NZ \frac{1}{A} + \frac{N(N-1)}{2} \frac{2}{A} = N \frac{A-1}{A}$ for a neutron (\texttt{norm\_ob::norm\_ob\_params.t~=-1})
	\end{itemize}
	\todo[inline,caption={}]{
	\textbf{Open shellness not taken into account here. Must be done somewhere else (higher up)...} \\	
	For closed shell nuclei everything seems fine. For open shells however we get some strange results. For example $^{27}$Al with $13$ protons and $14$ neutrons has an open $1d\frac{5}{2}$ proton shell. Open-shell nuclei are treated as closed shell but the pairs in the open shells get a weight factor. This weight factor however is \textbf{not} present in the method \texttt{norm::ob\_get\_me(pair,...)}. Hence as $A = 27$ but the closed shell equivalent with $A=28$ causes the number of pairs to be $28\cdot 27 /2$ instead of $ 27 \cdot 26 /2$. We get
	\begin{itemize}
	\item $ \frac{ 28 \cdot 27}{2} \frac{2}{27} = 28$ ( \texttt{norm\_ob::norm\_ob\_params.t = 0}) 
	\item $ \frac{ 14 \cdot 13}{2} \frac{2}{27} + \frac{14 \cdot 14 }{27} = \frac{378}{27} = 14 $ (\texttt{norm\_ob::norm\_ob\_params.t~=~1}) \\
	\item $ \frac{14 \cdot 14 }{27} + \frac{ 14 \cdot 13}{2} \frac{2}{27} = \frac{378}{27} = 14 $ (\texttt{norm\_ob::norm\_ob\_params.t~=-~1}) \\
	\end{itemize}
	}
	\item \texttt{norm\_ob::get\_me\_corr\_right( Pair )}.
\end{itemize}

\subsection{ density\_ob\_integrand3 }
Here we look at the file \texttt{ density\_ob\_integrand3}.

\subsection{ density\_ob\_integrand\_cf }
cf probably stands for correlation function. This class calculates integrals of the form
\begin{align*}
F_{p_1}(P) = \int dr r^{i+2} j_l(\frac{rP}{\sqrt{\nu}})  j_k(\frac{r p_1\sqrt{2}}{\sqrt{\nu}} )  f(\frac{r}{\sqrt{\nu}})  e^{\frac{-r^2}{2}}
\end{align*}
Where $p$ is the one-body momentum and $P$ is the c.m. momentum. This corresponds with the $\chi$ symbols defined (??).
\begin{align*}
	\chi_{p,nl}^{kK}(p_1,P) = \int \text{d} r\, r^{2} f_{p}(r) R_{n l}(r) j_{k}( \sqrt{2} p_1 r)  j_{K}(P r)
\end{align*}
With  $R_{nl}(r) = N_{nl} \nu^{\frac{l + 3/2}{2}} r^{l} e^{-\nu r^{2} /2} L_{n}^{l+1/2}(\nu r^{2})$ and $ \nu = M_N \omega / \hbar $,
\begin{align*}
	\chi_{p,nl}^{kK}(p_1,P) = N_{nl} \nu^{\frac{l + 3/2}{2}} \int \text{d} r\, r^{2+l} f_{p}(r)  e^{-\nu r^{2} /2} L_{n}^{l+1/2}(\nu r^{2}) j_{k}( \sqrt{2} p_1 r)  j_{K}(P r)
\end{align*}
Expanding the Generalized-Laguerre polynomials gives,
\begin{align*}
	\chi_{p,nl}^{kK}(p_1,P) = N_{nl} \nu^{\frac{l + 3/2}{2}} \sum_{i=0}^{n} a_{nl,i} \int \text{d} r\, r^{2+l} f_{p}(r)  e^{-\nu r^{2} /2}  (\nu r^{2})^{i} j_{k}( \sqrt{2} p_1 r)  j_{K}(P r)
\end{align*}
Changing variables $ r \rightarrow r/\sqrt{\nu}$ gives,
\begin{align*}
	\chi_{p,nl}^{kK}(p_1,P) =  N_{nl} \nu^{-\frac{3}{4}} \sum_{i=0}^{n} a_{nl,i} \int \text{d} r\, r^{2+l+2i} f_{p}( \nu^{-\frac{1}{2}} r)  e^{-r^{2} /2} j_{k}( \nu^{-\frac{1}{2}} \sqrt{2} p_1 r)  j_{K}(\nu^{-\frac{1}{2}} P r)
\end{align*}
This is exactly what is found in \texttt{density\_ob\_integrand\_cf::integrand} and \\ \texttt{density\_ob\_integrand\_cf::get\_value}.
The integrals are stored in a map where the key field contains the order of the spherical Bessel functions $k,K$ and is calculated as $100k+K$. It is necessary to assume that $ K < 100$.
The value field contains a two dimensional vector (\texttt{std::vector<std::vector<double>>}).
The first dimension (index) corresponds with the power of $r$ in the integrand and ranges from $0$ to $2n+l+2$.
The second dimension (index) corresponds with the different discretized values of $P$.
\section{One body momentum distribution}
We will look into one-body momentum distributions. A matrix element as calculated in the norm (??) is now extended by including the ony-body momentum operator $\hat{n}_{s,t}^{[1]}(\vec{p})$. $s$ is the spin projection of the nucleon and $t$ the isospin projection.
\begin{align*}
	\braket{A | \hat{n}_{s,t}^{[1]}(p) | A'} = \braket { A \equiv n (l S) j m_j N L M_L T M_T | \hat{\mathcal{O}}^{p\dagger} f_{p}^{\dagger} \hat{n}_{s,t}^{[1]}(\vec{p}) f_{q} \hat{ \mathcal{O}}^{q} | A' \equiv n' (l' S') j' m_j' N' L' M_L' T' M_T' }
\end{align*}
The one-body momentum operator is given by,
\begin{align*}
	\hat{n}_{s_1,t_1}^{[1]}(\vec{p}_1) = \ket{\vec{p}_1 s_1 t_1} \bra{\vec{p}_1 s_1 t_1} &= \sum_{s_2,t_2} \int \text{d}^{3} \vec{p}_{2} \, n_{ \substack{ s_1,t_1 \\ s_2,t_2} }^{[2]}(\vec{p}_1,\vec{p}_2)\\
	& = \sum_{s_2,t_2} \int \text{d}^{3} \vec{p}_{2} \ket{ \vec{p}_1 s_1 t_1, \vec{p}_2 s_2 t_2 } \bra { \vec{p}_1 s_1 t_1, \vec{p}_2 s_2 t_2}
\end{align*}
Hence,
\todo[inline]{Do spin projection before inserting coordinates}
\begin{multline*}
	\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(\vec{p}_1) | A'} = \sum_{s_2,t_2} \int \text{d}^{3} \vec{p}_{2} \braket{ A | \hat{\mathcal{O}}^{p\dagger} f_{p}^{\dagger} | \vec{p}_1 s_1 t_1, \vec{p}_2 s_2 t_2 } \braket{ \vec{p}_1 s_1 t_1, \vec{p}_2 s_2 t_2 | f_{q} \hat{ \mathcal{O}}^{q} | A'} \\
	=  \sum_{s_2,t_2} \int \text{d}^{3} \vec{p}_{2} \text{d}^{3} \vec{r}_{1} \text{d}^{3} \vec{r}_{2} \text{d}^{3} \vec{r}_{1}^{\, \prime} \text{d}^{3} \vec{r}_{2}^{\, \prime} \\
	 \braket{ A | \hat{\mathcal{O}}^{p\dagger} f_{p}^{\dagger} | \vec{r}_{1} s_1 t_1, \vec{r}_{2} s_2 t_2 } \braket{ \vec{r}_1 \vec{r}_2 | \vec{p}_1 \vec{p}_2 } \braket{ \vec{p}_1 \vec{p}_2 | \vec{r}_{1}^{\, \prime} \vec{r}_{2}^{\, \prime} } \braket{ \vec{r}_{1}^{\, \prime} s_1 t_1 , \vec{r}_{2}^{\, \prime} s_2 t_2 | f_{q} \hat{ \mathcal{O}}^{q} | A'}
\end{multline*}
With $\braket{ \vec{r} | \vec{p} } = \frac{1}{(2 \pi)^{3/2}} e^{i \vec{p} \cdot \vec{r}}$ and $ \vec{R}_{12} = \frac{\vec{r}_{1} + \vec{r}_{2}}{\sqrt{2}}, \vec{r}_{12} = \frac{\vec{r}_{1} - \vec{r}_{2}}{\sqrt{2}}$.
\begin{multline*}
	\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(\vec{p}_1) | A'} =  \frac{1}{(2 \pi)^{6}} \sum_{s_2,t_2} \int \text{d}^{3} \vec{p}_{2} \text{d}^{3} \vec{R}_{12} \text{d}^{3} \vec{r}_{12} \text{d}^{3} \vec{R}_{12}^{\, \prime} \text{d}^{3} \vec{r}_{12}^{\, \prime}  e^{ i \vec{p}_{1} \cdot ( \vec{r}_{1} - \vec{r}_{1}^{\, \prime}) } e^{ i \vec{p}_{2} \cdot ( \vec{r}_{2} - \vec{r}_{2}^{\, \prime} )} \\
	\braket{ A | \hat{\mathcal{O}}^{p\dagger} f_{p}^{\dagger} | \vec{R}_{12} s_1 t_1, \vec{r}_{12} s_2 t_2 } \braket{ \vec{R}_{12}^{\, \prime} s_1 t_1 \vec{r}_{12}^{\, \prime} s_2 t_2 | f_{q} \hat{ \mathcal{O}}^{q} | A'}
\end{multline*}
With $ \vec{r}_{1} - \vec{r}_{1}^{\, \prime} = \frac{\vec{R}_{12} + \vec{r}_{12} - \vec{R}_{12}^{\, \prime} - \vec{r}_{12}^{\, \prime}}{\sqrt{2}}$, $\vec{r}_{2} - \vec{r}_{2}^{\, \prime} = \frac{\vec{R}_{12} - \vec{r}_{12} - \vec{R}_{12}^{\, \prime} + \vec{r}_{12}^{\, \prime}}{\sqrt{2}}$, we have,
\begin{align*}
	\int \text{d}^{3} \vec{p}_{2} e^{ i \vec{p}_{2} \cdot ( \vec{r}_{2} - \vec{r}_{2}^{\, \prime} )} = (2 \pi)^{3} \sqrt{2}^{3} \delta^{(3)}( \vec{R}_{12} - \vec{r}_{12} - \vec{R}_{12}^{\, \prime} + \vec{r}_{12}^{\, \prime} )
\end{align*}
\begin{multline*}
	\braket{ A | \hat{n}_{s_1, t_1}^{[1]}(\vec{p}_1) | A'} = \frac{\sqrt{8}}{(2 \pi)^{3}} \sum_{s_2,t_2} \int \text{d}^{3} \vec{R}_{12} \text{d}^{3} \vec{r}_{12} \text{d}^{3} \vec{r}_{12}^{\, \prime}  e^{ i \sqrt{2} \vec{p}_{1} \cdot ( \vec{r}_{12} - \vec{r}_{12}^{\, \prime}) } \\
	 \braket{ A | \hat{\mathcal{O}}^{p\dagger} f_{p}^{\dagger} | \vec{R}_{12} s_1 t_1, \vec{r}_{12} s_2 t_2 } \braket{ \vec{R}_{12}^{\, \prime} s_1 t_1 , \vec{r}_{12}^{\, \prime} s_2 t_2 | f_{q} \hat{ \mathcal{O}}^{q} | A'} \Big|_{\vec{R}_{12}^{\, \prime} = \vec{R}_{12} - \vec{r}_{12}  + \vec{r}_{12}^{\, \prime} }
\end{multline*}
Let us investigate the matrix element with the operators $ \hat{\mathcal{O}}^{p,q}$ (central,tensor or spin-isospin) and the spin/isospin projections $s_1,t_1,s_2,t_2$ in detail: 
\begin{align*}
\sum_{s_2,t_2} \braket{ A | \hat{\mathcal{O}}^{p\dagger} | s_1 t_1, s_2 t_2} \braket{ s_1 t_1, s_2 t_2 | \hat{ \mathcal{O}}^{q} | A'}
\end{align*}
Using the expressions for $ \hat{ \mathcal{O}}^{p}  \ket{ A'} $ (??) this becomes,
\begin{multline*}
	 \sum_{s_2,t_2} \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \text{O}^{p \dagger}(S,T,j,l,l_p) \text{O}^{q}(S',T',j',l',l_q') \\
	 \braket{ n (l_p S) j m_j N L M_L T M_T | s_1 t_1, s_2 t_2} \braket{ s_1 t_1, s_2 t_2 | n' (l_q' S') j' m_j' N' L' M_L' T' M_T'} \\
\end{multline*}
with
\begin{align*}
	\braket{ \frac{1}{2} s_1 \frac{1}{2} s_2 | (l S) j m_j} &= \sum_{m_l m_s} \braket{ l m_l S m_S | j m_j } \braket{   \frac{1}{2} s_1 \frac{1}{2} s_2 | S m_S} \ket{ l m_l} \\
	&= \braket{ l m_l S m_S | j m_j } \braket{   \frac{1}{2} s_1 \frac{1}{2} s_2 | S m_S} \ket{ l m_l} \Big|_{ \substack{ m_S = s_1 + s_2 \phantom{ + m_j} \\ m_l = m_j - s_1 - s_2} }
\end{align*}
We get,
\begin{multline*}
\sum_{s_2,t_2} \braket{ A | \hat{\mathcal{O}}^{p\dagger} | s_1 t_1, s_2 t_2} \braket{ s_1 t_1, s_2 t_2 | \hat{ \mathcal{O}}^{q} | A'} = \\
 \sum_{s_2,t_2} \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \text{O}^{p \dagger}(S,T,j,l,l_p) \text{O}^{q}(S',T',j',l',l_q') \\
 	\braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | T M_T } \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | T' M_T'} \\
	\braket{ l_p  m_{l_p} S m_S | j m_j } \braket{   \frac{1}{2} s_1 \frac{1}{2} s_2 | S m_S} \bra{ l_p m_{l_p} }
	\braket{ l_q' m_{l_q}' S' m_S' | j' m_j' } \braket{   \frac{1}{2} s_1 \frac{1}{2} s_2 | S' m_S'} \ket{ l_q' m_{l_q}'}
\end{multline*}
\begin{multline*}
	\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(\vec{p}_1) | A'} =  \sum_{s_2,t_2} \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \text{O}^{p\dagger}(S,T,j,l,l_p) \text{O}^{q}(S',T',j',l',l_q') \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | T M_T } \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | T' M_T'} \\
	\braket{ l_p  m_{l_p} S m_S | j m_j } \braket{   \frac{1}{2} s_1 \frac{1}{2} s_2 | S m_S} 
	\braket{ l_q' m_{l_q}' S' m_S' | j' m_j' } \braket{   \frac{1}{2} s_1 \frac{1}{2} s_2 | S' m_S'} \\
 \frac{\sqrt{8}}{(2 \pi)^{3}} \int \text{d}^{3} \vec{R}_{12} \text{d}^{3} \vec{r}_{12} \text{d}^{3} \vec{r}_{12}^{\, \prime}  e^{ i \sqrt{2} \vec{p}_{1} \cdot ( \vec{r}_{12} - \vec{r}_{12}^{\, \prime}) } f_{p}^{\dagger}(r_{12}) f_{q}(r_{12}') \\
   \psi_{N L M_L}^{\dagger}(\vec{R}_{12}) \psi_{ n l_p m_{l_p} }^{\dagger}(\vec{r}_{12}) \psi_{N' L' M_L'}(\vec{R}_{12}^{\, \prime}) \psi_{ n' l_q' m_{l_q'} } (\vec{r}_{12}^{\, \prime}) \Big|_{ \substack{ \vec{R}_{12}^{\, \prime} = \vec{R}_{12} - \vec{r}_{12}  + \vec{r}_{12}^{\, \prime} \\ m_{l_p} = m_j - s_1 - s_2 \\ m_{l_q'} = m_j' - s_1 - s_2 }}
\end{multline*}
For the sake of brevity we define,
\begin{multline*}
 \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) = \text{O}^{p\dagger}(S,T,j,l,l_p) \text{O}^{q}(S',T',j',l',l_q') \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | T M_T } \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | T' M_T'} \\
	\braket{ l_p  m_{l_p} S m_S | j m_j } \braket{   \frac{1}{2} s_1 \frac{1}{2} s_2 | S m_S} 
	\braket{ l_q' m_{l_q}' S' m_S' | j' m_j' } \braket{   \frac{1}{2} s_1 \frac{1}{2} s_2 | S' m_S'} \\
\end{multline*}
Writing the wave functions as Fourier transformations $ \psi_{N L M_L}(\vec{R}_{12}) = 1/(2 \pi)^{3/2} \int \text{d}^{3} \vec{P}_{12} e^{ i \vec{P}_{12} \cdot \vec{R}_{12}} \phi_{N L M_L}(\vec{P}_{12})$,
\begin{multline*}
	\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(\vec{p}_1) | A'} = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
   \frac{\sqrt{8}}{(2 \pi)^{3}} \int \text{d}^{3} \vec{R}_{12} \text{d}^{3} \vec{r}_{12} \text{d}^{3} \vec{r}_{12}^{\, \prime}  e^{ i \sqrt{2} \vec{p}_{1} \cdot ( \vec{r}_{12} - \vec{r}_{12}^{\, \prime}) }  f_{p}^{\dagger}(r_{12}) f_{q}(r_{12}') \psi_{ n l_p m_{l_p} }^{\dagger}(\vec{r}_{12}) \psi_{ n' l_q' m_{l_q'} }(\vec{r}_{12}^{\, \prime})  \\
   \frac{1}{(2 \pi)^{3}} \int \text{d}^{3} \vec{P}_{12} \int \text{d}^{3} \vec{P}_{12}^{\, \prime} e^{ -i \vec{P}_{12} \cdot \vec{R}_{12}} \phi_{N L M_L}^{\dagger}(\vec{P}_{12}) e^{ i \vec{P}_{12}^{\, \prime} \cdot ( \vec{R}_{12} - \vec{r}_{12} + \vec{r}_{12}^{\, \prime})} \phi_{N' L' M_L'}(\vec{P}_{12}^{\, \prime}) \\
   = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
    \frac{\sqrt{8}}{(2 \pi)^{3}} \int \text{d}^{3} \vec{r}_{12} \text{d}^{3} \vec{r}_{12}^{\, \prime}  e^{ i \sqrt{2} \vec{p}_{1} \cdot ( \vec{r}_{12} - \vec{r}_{12}^{\, \prime}) } f_{p}^{\dagger}(r_{12}) f_{q}(r_{12}')  \psi_{ n l_p m_{l_p}}^{\dagger}(\vec{r}_{12}) \psi_{ n' l_q' m_{l_q}' }(\vec{r}_{12}^{\, \prime}) \\
   \int \text{d}^{3} \vec{P}_{12} e^{ -i \vec{P}_{12} \cdot (\vec{r}_{12} - \vec{r}_{12}^{\, \prime})} \phi_{N L M_L}^{\dagger}(\vec{P}_{12}) \phi_{N' L' M_L'}(\vec{P}_{12}) 
\end{multline*}
Using the plane wave expansion $e^{i \vec{p} \cdot \vec{r}} = 4 \pi \sum_{l m_l} i^{l} j_{l}(p r) Y_{l m_l}^{*}(\Omega_{p}) Y_{l m_l}(\Omega_{r}) = 4 \pi \sum_{l m_l} i^{l} j_{l}(p r) Y_{l m_l}(\Omega_{p}) Y_{l m_l}^{*}(\Omega_{r})$ and the fact that the isotropic harmonic oscillator wavefunctions factorize in $\psi_{n l m_l}(\vec{r}) = R_{n l}(r) Y_{l m_l}(\Omega_{r})$, $\psi_{n l m_l}(\vec{p}) = \Pi_{n l}(p) Y_{l m_l}(\Omega_{p})$.
\begin{multline*}
	\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(\vec{p}_1) | A'} = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
  \frac{\sqrt{8}}{(2 \pi)^{3}} \int \text{d}^{3} \vec{R}_{12} \text{d}^{3} \vec{r}_{12} \text{d}^{3} \vec{r}_{12}^{\, \prime}  e^{ i \sqrt{2} \vec{p}_{1} \cdot ( \vec{r}_{12} - \vec{r}_{12}^{\, \prime}) }  f_{p}^{\dagger}(r_{12}) f_{q}(r_{12}') \psi_{ n l_p m_{l_p}}^{\dagger}(\vec{r}_{12}) \psi_{ n' l_q' m_{l_q'}}(\vec{r}_{12}^{\, \prime})  \\
   \frac{1}{(2 \pi)^{3}} \int \text{d}^{3} \vec{P}_{12} \int \text{d}^{3} \vec{P}_{12}^{\, \prime} e^{ -i \vec{P}_{12} \cdot \vec{R}_{12}} \phi_{N L M_L}^{\dagger}(\vec{P}_{12}) e^{ i \vec{P}_{12}^{\, \prime} \cdot ( \vec{R}_{12} - \vec{r}_{12} + \vec{r}_{12}^{\, \prime})} \phi_{N' L' M_L'}(\vec{P}_{12}^{\, \prime}) \\
   = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
    \frac{\sqrt{8} (4 \pi)^{4}}{(2 \pi)^{3}} \int \text{d}^{3} \vec{r}_{12} \text{d}^{3} \vec{r}_{12}^{\, \prime} f_{p}^{\dagger}(r_{12}) f_{q}(r_{12}')  R_{n l_p}(r_{12}) Y_{l_p m_{l_p}}^{*}(\Omega_{r_{12}}) R_{n' l_q'}(r_{12}') Y_{l_q' m_{l_q'}}(\Omega_{r_{12}'}) \\
   \sum_{k m_k} i^{k} j_{k}( \sqrt{2} p_1 r_{12}) Y_{k m_k}^{*}(\Omega_{p_1}) Y_{k m_k}(\Omega_{r_{12}}) \\
   \sum_{k' m_k'} i^{-k'} j_{k'}( \sqrt{2} p_1 r_{12}') Y_{k' m_k'}(\Omega_{p_1}) Y_{k' m_k'}^{*}(\Omega_{r_{12}'}) \\
   \int \text{d}^{3} \vec{P}_{12} \Pi_{N L}(P_{12}) Y_{L M_L}^{*}(\Omega_{P_{12}}) \Pi_{N' L'}(P_{12}) Y_{L' M_L'}(\Omega_{P_{12}})   \\
   \sum_{K m_K} i^{-K} j_{K}(P_{12} r_{12}) Y_{K m_K}^{*}(\Omega_{P_{12}}) Y_{K m_K}(\Omega_{r_{12}}) \\
   \sum_{K' m_K'} i^{K'} j_{K'}(P_{12} r_{12}') Y_{K' m_K'}(\Omega_{P_{12}}) Y_{K' m_K'}^{*}(\Omega_{r_{12}'}) \\
\end{multline*}
\begin{multline*}
\braket{ A | \hat{n}^{[1]}_{s_1,t_1}(\vec{p}_1) | A'} = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
64 \sqrt{2} \pi \sum_{k m_k} \sum_{k' m_k'} \sum_{K m_K} \sum_{K' m_K'} i^{k-k'-K+K'} Y_{k m_k}^{*}(\Omega_{p_1}) Y_{k' m_k'}(\Omega_{p_1}) \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12})\\
 \int \text{d} r_{12}\, r_{12}^{2} f_{p}^{\dagger}(r_{12}) R_{n l_p}(r_{12}) j_{k}( \sqrt{2} p_1 r_{12})  j_{K}(P_{12} r_{12}) \\
\int \text{d} r_{12}' \, r_{12}^{\prime \, 2} f_{q}(r_{12}')  R_{n' l_q'}(r_{12}') j_{k'}( \sqrt{2} p_1 r_{12}')  j_{K'}(P_{12} r_{12}') \\
 \int \text{d}^{2} \Omega_{r_{12}}  Y_{l_p m_{l_p} }^{*}(\Omega_{r_{12}}) Y_{k m_k}(\Omega_{r_{12}}) Y_{K m_K}(\Omega_{r_{12}}) \\
 \int \text{d}^{2} \Omega_{r_{12}'}  Y_{ l_q' m_{l_q'} }(\Omega_{r_{12}'})  Y_{k' m_k'}^{*}(\Omega_{r_{12}'}) Y_{K' m_K'}^{*}(\Omega_{r_{12}'}) \\
   \int \text{d}^{2} \Omega_{P_{12}}  Y_{L M_L}^{*}(\Omega_{P_{12}})  Y_{L' M_L'}(\Omega_{P_{12}}) Y_{K m_K}^{*}(\Omega_{P_{12}}) Y_{K' m_K'}(\Omega_{P_{12}})
\end{multline*}
As in Eq. (D.38) we define,
\begin{align*}
	\chi_{p,nl}^{kK}(p_1,P) = \int \text{d} r\, r^{2} f_{p}(r) R_{n l}(r) j_{k}( \sqrt{2} p_1 r)  j_{K}(P r)
\end{align*}
Using the identity (see for example \textit{Sakurai, modern quantum mechanics})
\begin{align*}
	Y_{ l m }(\Omega) Y_{ l' m'}(\Omega) = \sum_{LM} \sqrt{ \frac{(2l+1)(2l'+1)}{4 \pi (2L+1)}} \braket{ l m l' m' | L M} \braket{ l 0 l' 0 | L 0 } Y_{L M}(\Omega)
\end{align*}
We can easily derive
\begin{align*}
	\int \text{d} \Omega \, Y_{ l m }(\Omega) Y_{ l' m'}(\Omega) Y_{ l'' m''}^{*}(\Omega) = \sqrt{ \frac{(2l+1)(2l'+1)}{4 \pi (2l''+1)}} \braket{ l m l' m' | l'' m''} \braket{ l 0 l' 0 | l'' 0 } \, ,
\end{align*}
%\begin{multline*}
%	\int \text{d} \Omega \, \mathcal{Y}_{ (l S) j m_j }(\Omega) Y_{ l' m'}(\Omega) Y_{ l'' m''}^{*}(\Omega) = \\
%	= \sum_{m m_S} \braket{ l m S m_S | j m_j} \int \text{d} \Omega \, Y_{ l m }(\Omega) Y_{ l' m'}(\Omega) Y_{ l'' m''}^{*}(\Omega) \\
%	= \sum_{m m_S} \braket{ l m S m_S | j m_j} \sqrt{ \frac{(2l+1)(2l'+1)}{4 \pi (2l''+1)}} \braket{ l m l' m' | l'' m''} \braket{ l 0 l' 0 | l'' 0 }
%\end{multline*}
and,
\begin{multline*}
	\int \text{d} \Omega \, Y_{ l m_l }(\Omega) Y_{ l' m_l'}(\Omega) Y_{ k m_k}^{*}(\Omega) Y_{ k' m_k'}^{*}(\Omega) \\
	= \int \text{d} \Omega \sum_{LM_L} \sqrt{ \frac{(2l+1)(2l'+1)}{4 \pi (2L+1)}} \braket{ l m_l l' m_l' | L M} \braket{ l 0 l' 0 | L 0 } Y_{L M}(\Omega) \\
	 \sum_{K M_K} \sqrt{ \frac{(2k+1)(2k'+1)}{4 \pi (2K+1)}} \braket{ k m_k k' m_k' | K M_K} \braket{ k 0 k' 0 | K 0 } Y_{K M_K}^{*}(\Omega) \\
	 = \sum_{LM_L} \sqrt{ \frac{(2l+1)(2l'+1)}{4 \pi (2L+1)}} \sqrt{ \frac{(2k+1)(2k'+1)}{4 \pi (2L+1)}} \braket{ l m_l l' m_l' | L M} \braket{ l 0 l' 0 | L 0 } \braket{ k m_k k' m_k' | L M_L} \braket{ k 0 k' 0 | L 0 } 
\end{multline*}
So we get for the one-body momentum matrix element,
\begin{multline*}
\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(\vec{p}_1) | A'} = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
 64 \sqrt{2} \pi \sum_{k m_k} \sum_{k' m_k'} \sum_{K M_K} \sum_{K' M_K'} i^{k-k'-K+K'} Y_{k m_k}^{*}(\Omega_{p_1}) Y_{k' m_k'}(\Omega_{p_1}) \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12}) \chi_{p,nl_p}^{kK\dagger}(p_1,P_{12}) \chi_{q,n'l_q'}^{k'K'}(p_1,P_{12}) \\
    \sqrt{ \frac{(2 k + 1)(2 K+1)}{4 \pi (2 l_p +1 )}} \braket{ k m_k K M_K | l_p m_{l_p}} \braket{ k 0 K 0 | l_p 0} \\
    \sqrt{ \frac{(2 k' + 1)(2 K'+1)}{4 \pi (2 l_q' +1 )}} \braket{ k' m_k' K' M_K' | l_q' m_{l_q'}} \braket{ k' 0 K' 0 | l_q' 0} \\
    \sum_{J M_J} \sqrt{ \frac{ (2L+1)(2K+1)}{ 4 \pi (2 J+1)} } \braket{ L M_L K M_K | J M_J} \braket{ L 0 K 0 | J 0 } \\ \sqrt{ \frac{ (2L'+1)(2K'+1)}{ 4 \pi (2 J+1)} } \braket{L' M_L' K' M_K' | J M_J } \braket{ L' 0 K' 0 | J 0 } \\ 
\end{multline*}
Introducing the notation $\hat{j} = \sqrt{2 j + 1}$ we get,
\begin{multline*}
\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(\vec{p}_1) | A'} = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
 \frac{ 4 \sqrt{2}}{\pi} \sum_{k m_k} \sum_{k' m_k'} \sum_{K M_K} \sum_{K' M_K'} i^{k-k'-K+K'} Y_{k m_k}^{*}(\Omega_{p_1}) Y_{k' m_k'}(\Omega_{p_1}) \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12}) \chi_{p,nl_p}^{kK\dagger}(p_1,P_{12}) \chi_{q,n'l_q'}^{k'K'}(p_1,P_{12}) \\
     \frac{ \hat{k} \hat{k}' \hat{K} \hat{K}' }{ \hat{l}_p \hat{l}_{q}'} \braket{ k m_k K M_K | l_p m_{l_p}} \braket{ k 0 K 0 | l_p 0} \braket{ k' m_k' K' M_K' | l_q' m_{l_q'}} \braket{ k' 0 K' 0 | l_q' 0} \\
    \sum_{J M_J} \frac{ \hat{L} \hat{L}' \hat{K} \hat{K}' }{\hat{J}^{2}} \braket{ L M_L K M_K | J M_J} \braket{ L 0 K 0 | J 0 } \braket{L' M_L' K' M_K' | J M_J } \braket{ L' 0 K' 0 | J 0 } \\ 
\end{multline*}
Integration over the ob-momentum angle $\Omega_{p_1}$ gives $ \delta_{k k'} \delta_{m_k m_k'}$,
\begin{multline*}
\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(p_1) | A'} = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
 \frac{ 4 \sqrt{2}}{\pi} \sum_{k m_k} \sum_{K M_K} \sum_{K' M_K'} i^{-K+K'} \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12}) \chi_{p,nl_p}^{kK\dagger}(p_1,P_{12}) \chi_{q,n'l_q'}^{k K'}(p_1,P_{12}) \\
     \frac{ \hat{k}^{2} \hat{K} \hat{K}' }{ \hat{l}_p \hat{l}_{q}'} \braket{ k m_k K M_K | l_p m_{l_p}} \braket{ k 0 K 0 | l_p 0} \braket{ k m_k K' M_K' | l_q' m_{l_q'}} \braket{ k 0 K' 0 | l_q' 0} \\
    \sum_{J M_J} \frac{ \hat{L} \hat{L}' \hat{K} \hat{K}' }{\hat{J}^{2}} \braket{ L M_L K M_K | J M_J} \braket{ L 0 K 0 | J 0 } \braket{L' M_L' K' M_K' | J M_J } \braket{ L' 0 K' 0 | J 0 }
\end{multline*}
To cross check this result with Maartens (D.37) we write the CGC coefficients as Wigner-3j symbols,
\begin{align*}
	\braket{ j_1 m_1 j_2 m_2 | J M } = (-1)^{j_1 - j_2 + M} \hat{J} \threej{j1,j2,J,m_1,m_2,-M}
\end{align*}
\begin{multline*}
\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(p_1) | A'} = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2) \\
 \frac{ 4 \sqrt{2}}{\pi} \sum_{k m_k} \sum_{K M_K} \sum_{K' M_K'} i^{-K+K'} (-1)^{ m_{l_p} + m_{l_q'}}  \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12}) \chi_{p,nl_p}^{kK\dagger}(p_1,P_{12}) \chi_{q,n'l_q'}^{k K'}(p_1,P_{12}) \\
     \hat{k}^{2} \hat{K} \hat{K}' \hat{l}_{p} \hat{l}_{q}' \threej{k,K,l_p,m_k,M_K,-m_{l_p}} \threej{k,K,l_p,0,0,0} \threej{k,K',l_q',m_k,M_K',-m_{l_q'}} \threej{k,K',l_q',0,0,0} \\
    \sum_{J M_J} \hat{L} \hat{L}' \hat{K} \hat{K}' \hat{J}^{2}  \threej{ L,K,J,M_L,M_K,M_J} \threej{ L,K,J,0,0,0} \threej{L',K',J,M_L',M_K',M_J} \threej{L',K',J,0,0,0} 
\end{multline*}
Where we flipped the sign of $M_J$ as it as a summation index. Writing $\mathcal{M}_{AA'}^{p q,l_p l_q'}(s_1,t_1,s_2,t_2)$ explicitly gives,
\begin{multline*}
\braket{ A | \hat{n}_{s_1,t_1}^{[1]}(p_1) | A'} = \sum_{s_2 t_2}  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \text{O}^{p\dagger}(S,T,j,l,l_p) \text{O}^{q}(S',T',j',l',l_q') \\
 (-1)^{M_T + M_T' + M_S + M_S' } \threej{ \frac{1}{2}, \frac{1}{2}, T, t_1,t_2, - M_T} \threej{ \frac{1}{2}, \frac{1}{2}, T', t_1,t_2, - M_T'} \threej{ \frac{1}{2}, \frac{1}{2}, S, s_1,s_2, - M_S} \threej{ \frac{1}{2}, \frac{1}{2}, S', s_1,s_2, - M_S'} \\
 (-1)^{ l_p + l_q' - S - S' + m_j + m_j'} \hat{j} \hat{j}' \threej{ l_p,S,j,m_{l_p},m_S,m_j} \threej{l_q',S',j',m_{l_q'},m_S',m_j'} \\
 \frac{ 4 \sqrt{2}}{\pi} \sum_{k m_k} \sum_{K M_K} \sum_{K' M_K'} i^{-K+K'} (-1)^{ m_{l_p} + m_{l_q'}}  \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12}) \chi_{p,nl_p}^{kK\dagger}(p_1,P_{12}) \chi_{q,n'l_q'}^{k K'}(p_1,P_{12}) \\
     \hat{k}^{2} \hat{K} \hat{K}' \hat{l}_{p} \hat{l}_{q}' \threej{k,K,l_p,m_k,M_K,-m_{l_p}} \threej{k,K,l_p,0,0,0} \threej{k,K',l_q',m_k,M_K',-m_{l_q'}} \threej{k,K',l_q',0,0,0} \\
    \sum_{J M_J} \hat{L} \hat{L}' \hat{K} \hat{K}' \hat{J}^{2}  \threej{ L,K,J,M_L,M_K,M_J} \threej{ L,K,J,0,0,0} \threej{L',K',J,M_L',M_K',M_J} \threej{L',K',J,0,0,0} 
\end{multline*}
If we are not interested in a specific spin contribution we get,
\begin{multline*}
\braket{ A | \hat{n}_{t_1}^{[1]}(p_1) | A'} = \sum_{s_1} \braket{ A | \hat{n}_{s_1,t_1}^{[1]}(p_1) | A'} =  \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \text{O}^{p\dagger}(S,T,j,l,l_p) \text{O}^{q}(S,T',j',l',l_q') \\
 \sum_{t_2} (-1)^{M_T + M_T' } \threej{ \frac{1}{2}, \frac{1}{2}, T, t_1,t_2, - M_T} \threej{ \frac{1}{2}, \frac{1}{2}, T', t_1,t_2, - M_T'} \\
 (-1)^{ l_p + l_q'+ m_j + m_j'}  \hat{j} \hat{j}' \threej{ l_p,S,j,m_{l_p},m_S,m_j} \threej{l_q',S,j',m_{l_q'},m_S,m_j'} \\
 \frac{ 4 \sqrt{2}}{\pi} \sum_{k m_k} \sum_{K M_K} \sum_{K' M_K'} i^{-K+K'} (-1)^{ m_{l_p} + m_{l_q'}}  \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12}) \chi_{p,nl_p}^{kK\dagger}(p_1,P_{12}) \chi_{q,n'l_q'}^{k K'}(p_1,P_{12}) \\
     \hat{k}^{2} \hat{K} \hat{K}' \hat{l}_{p} \hat{l}_{q}' \threej{k,K,l_p,m_k,M_K,-m_{l_p}} \threej{k,K,l_p,0,0,0} \threej{k,K',l_q',m_k,M_K',-m_{l_q'}} \threej{k,K',l_q',0,0,0} \\
    \sum_{J M_J} \hat{L} \hat{L}' \hat{K} \hat{K}' \hat{J}^{2}  \threej{ L,K,J,M_L,M_K,M_J} \threej{ L,K,J,0,0,0} \threej{L',K',J,M_L',M_K',M_J} \threej{L',K',J,0,0,0} 
\end{multline*}
To make the comparison with (D.37) easier we swap variables: $J M_J \rightarrow q m_q$, $K M_K \rightarrow k m_k$, $K' M_K' \rightarrow k' m_k'$, $ k m_k \rightarrow l_1 m_{l_1}$
\begin{multline*}
    \braket{ A | \hat{n}_{s_1,t_1}^{[1]}(p_1) | A'} = \sum_{l_p = |j-1|}^{j+1} \sum_{l_q' = |j' - 1|}^{j'+1} \text{O}^{p\dagger}(S,T,j,l,l_p) \text{O}^{q}(S,T',j',l',l_q') \\
 \sum_{t_2} (-1)^{M_T + M_T' } \threej{ \frac{1}{2}, \frac{1}{2}, T, t_1,t_2, - M_T} \threej{ \frac{1}{2}, \frac{1}{2}, T', t_1,t_2, - M_T'} \\
 (-1)^{ l_p + l_q'+ m_j + m_j'}  \hat{j} \hat{j}' \threej{ l_p,S,j,m_{l_p},m_S,m_j} \threej{l_q',S,j',m_{l_q'},m_S,m_j'}
 \frac{ 4 \sqrt{2}}{\pi} \sum_{l_1 m_{l_1}} \sum_{k m_k} \sum_{k' m_k'} i^{-k+k'} (-1)^{ m_{l_p} + m_{l_q'}}  \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12}) \chi_{p,nl_p}^{l_1 k\dagger}(p_1,P_{12}) \chi_{q,n'l_q'}^{l_1 k'}(p_1,P_{12}) \\
     \hat{l}_{1}^{2} \hat{k}^{2} \hat{k}'^{2} \hat{l}_{p} \hat{l}_{q}' \hat{L} \hat{L}'
     \threej{l_p,l_1,k,-m_{l_p},m_{l_1},m_k}
     \threej{l_p,l_1,k,0,0,0}
     \threej{l_q',l_1,k',-m_{l_q'},m_{l_1},m_k'}
     \threej{l_q',l_1,k',0,0,0} \\
     \sum_{q m_q} \hat{q}^{2}
     \threej{ L,k,q,M_L,m_k,m_q}
     \threej{ L,k,q,0,0,0}
     \threej{L',k',q,M_L',m_k',m_q}
     \threej{L',k',q,0,0,0} 
\end{multline*}
Finally we make use of the fact that $m_{l_1}$ and $m_{k}$ are sum indices to flip their sign and
\begin{align*}
	\threej{l_p,l_1,k,-m_{l_p},-m_{l_1},-m_{k}} = \threej{l_p,l_1,k,-m_{l_p},-m_{l_1},-m_{k}}
\end{align*}
and compare our expression against (D.37) (using a final ``trick'' $ (-1)^{-k} = i^{-2k}$). Parts that are not found in (D.37) are colored \textcolor{red}{red}. Parts in (D.37) not appearing here are colored \textcolor{blue}{blue} (I think Maarten intended to write \textcolor{blue}{$L,L'$} in stead of \textcolor{blue}{$L_A,L_B$}).
\begin{multline*}
\braket{ A | \hat{n}_{s_1, t_1}^{[1]}(p_1) | A'} = \mathcal{M}_{A A'}^{p,q}(s_1,t_1) \frac{4 \sqrt{2}}{\pi} \sum_{l_1 m_{l_1}} \sum_{k m_k} \sum_{k' m_k'} (-1)^{l+l'\textcolor{red}{-S-S'}+m_j+m_j'} i^{\textcolor{blue}{L_A-L_B}+k'-k} \hat{l}_{1}^{2} \hat{k}^{2} \hat{k}'^{2} \hat{l} \hat{l}' \hat{L} \hat{L}' \hat{j}  \hat{j}'  \\
 \int \text{d} P_{12} \, P_{12}^{2} \Pi_{N L}(P_{12}) \Pi_{N' L'}(P_{12}) \chi_{p,nl}^{l_1 k\dagger}(p_1,P_{12}) \chi_{q,n'l'}^{ l_1 k'}(p_1,P_{12}) \\
 \textcolor{red} {\sum_{m_l m_S} \threej{l,S,j,m_l,m_S,-m_j}} \threej{ l, l_1, k, m_l, m_{l_1}, m_k } \threej{l, l_1, k,0,0,0}  \\
  \textcolor{red}{\sum_{m_l' m_S'} \threej{l',S',j',m_l',m_S',-m_j'}} \threej{l',l_1,k',m_l',m_{l_1},m_k'}  \threej{l',l_1,k',0,0,0}  \\
   \sum_{q m_q} \threej{L',k,q,M_L',m_k,m_q} \threej{L',k,q,0,0,0} \threej{L,k',q,M_L,m_k',m_q} \threej{L,k',q,0,0,0} 
\end{multline*}
In the case that Maarten has simply omitted the LS coupling but than there should \textbf{not} be $(-1)^{l+l'm_j+m_j'}$ as this stems from the 3j LS coupling symbol.
\subsection{The matrix element $\mathcal{M}_{A A'}^{p,q}(s_1,t_1)$}
Let us now look into the factorized matrix element $\mathcal{M}_{A A'}^{p,q}(s_1,t_1)$ in the one-body momentum distribution . Note that we implicitly assumed that the operators $\mathcal{O}^{p,q}$ do not change the quantum numbers of the orbital wave functions, $ n (lS) j m_j N L M_L$ (the quantum numbers involved in the radial integrals). More explicitly,
\begin{align*}
	\hat{\mathcal{O}}^{p} \ket{ n (lS) j m_j N L M_L } = \text{O}^{p}(n,l,S,j,m_j,N,L,M_L) \ket{ n (lS) j m_j N L M_L }
\end{align*}
If not it is impossible to factorize $\mathcal{M}_{A A'}^{p,q}(s_1,t_1)$ as is done in (above (??)). We now investigate this in detail to make sure this is the case.
For the central and spin-isospin operators $\hat{\mathcal{O}} = \mathbb{1}, \vec{\sigma}_{1} \cdot \vec{\sigma_{2}} \vec{ \tau}_{1} \cdot \vec{ \tau}_{2} $ this is trivially valid,
\begin{align*}
	\mathbb{1} \ket{ n (lS) j m_j N L M_L } &= \ket{ n (lS) j m_j N L M_L } \\
	\vec{\sigma}_{1} \cdot \vec{\sigma_{2}} \vec{ \tau}_{1} \cdot \vec{ \tau}_{2} \ket{ n (lS) j m_j N L M_L } &= \left[ 2 S(S+1) - 3 \right] \ket{ n (lS) j m_j N L M_L } \vec{ \tau}_{1} \cdot \vec{ \tau}_{2}
\end{align*}
The case for the tensor operator $\hat{S}_{12} = 2 \left[ 3 \frac{ \vec{S} \cdot \vec{r}_{12}}{r_{12}^{2}} - \vec{S}^{2} \right]$ requires a bit more work. As it only operates on the total spin $S$ and the (unit) relative coordinate $r_{12}$ we only write out the ket $\ket{ (l S) j m_j}$ and drop $ \ket{n} \ket{ N L M_L}$.
\todo[inline]{Maybe one can use something like a general thing that scalar operators cannot change quantum numbers but let us proof it explicitly for our case.}
\begin{align*}
	\hat{S}_{12} \ket{ (lS) j m_j} &= \sum_{l' S' j' m_j'} \ket{ (l' S') j' m_j' } \bra{ (l' S') j' m_j'} \hat{S}_{12} \ket{ (lS) j m_j} \\
	&= \sum_{l' S' j' m_j'} \ket{ (l' S') j' m_j' } 2 \delta_{jj'} \delta_{m_j m_j'} (-1)^{S+j} \sqrt{ 120 } \, \hat{l} \hat{l}' \threej{l,l',2,0,0,0} \sixj{l,l',2,S',S,j} \delta_{jj'} \delta_{m_j m_j'} \delta_{S S'} \delta_{S1} \\
	&= \sum_{l'=|j-1|}^{j+1} \ket{ (l' S) j m_j } (-1)^{S+j} \sqrt{ 120 } \, \hat{l} \hat{l}' \threej{l,l',2,0,0,0} \sixj{l,l',2,S,S,j} \delta_{S1} \\
	&= \sum_{l'=|j-1|}^{j+1} \text{S}_{12}(S,j,l,l') \ket{ (l' S) j m_j }
\end{align*}
Where we have made use of the unity,
\begin{align*}
\sum_{l S j m_j} \ket{ (l S) j m_j} \bra{ (l S) j mj} &= \sum_{l S j m_j} \sum_{ m_l m_S} \sum_{m_l' m_S'} \braket{ l m_l S m_S | j m_j } \ket{ l m_l S m_S} \braket{ j m_j | l m_l' S m_S'} \bra{ l m_l' S m_S'} \\
&= \sum_{l S} \sum_{ m_l m_S} \sum_{m_l' m_S'}  \ket{ l m_l S m_S}  \bra{ l m_l' S m_S'} \sum_{j m_j} \braket{ l m_l S m_S | j m_j } \braket{ j m_j | l m_l' S m_S'} \\
&=  \sum_{l S} \sum_{ m_l m_S} \ket{ l m_l S m_S}  \bra{ l m_l S m_S} = \mathbb{1}
\end{align*}
Summarizing we can write,
\begin{align*}
	\hat{\mathcal{O}}^{p} \ket{ n (lS) j m_j N L M_L T M_T } = \sum_{l' = |j-1|}^{j+1} \text{O}^{p}(S,T,j,l,l') \ket{ n (l'S) j m_j N L M_L T M_T }
\end{align*}
With
\begin{align*}
	\hat{\mathcal{O}}^{p} = \mathbb{1} & \Rightarrow  \text{O}^{p}(S,T,j,l,l') = \delta_{l l'} \\
	\hat{\mathcal{O}}^{p} = \vec{\sigma}_{1} \cdot \vec{\sigma_{2}} \vec{ \tau}_{1} \cdot \vec{ \tau}_{2} & \Rightarrow  \text{O}^{p}(S,T,j,l,l') = [ 2S(S+1) - 3 ] [ 2T(T+1) - 3] \delta_{l l'}\\
	\hat{\mathcal{O}}^{p} =  \hat{S}_{12} &\Rightarrow \text{O}^{p}(S,T,j,l,l') = \text{S}_{12}(S,j,l,l')
\end{align*}
\subsection{Isospin projection part}
Let us investigate the expression,
\begin{align*}
	\sum_{t_2} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | T M_T} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | T' M_T'} = \sum_{t_2} (-1)^{M_T + M_T' } \threej{ \frac{1}{2}, \frac{1}{2}, T, t_1,t_2, - M_T} \threej{ \frac{1}{2}, \frac{1}{2}, T', t_1,t_2, - M_T'}
\end{align*}
separately as in Maartens code the 3j symbols do not appear but some \texttt{if, else} magic is employed. We will cover the 3 cases for $\ket{ T M_T}, \ket{ T' M_T'} \in \{ \ket{1 1} , \ket{ 1 0 }, \ket{ 1 -1} , \ket{ 0 0} \}$, leading to 10 ($\frac{ 4 \cdot 5}{2}$) possible combinations:
\begin{align*}
	\sum_{t_2} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1 \pm 1} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1 \mp 1 } &= 
	0 \\
	\sum_{t_2} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1 \pm 1} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1 \pm 1 } &=
	\delta_{t_1,\pm \frac{1}{2}} \\
	\sum_{t_2} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1 \pm 1} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1  0 } &=
	0 \\
	\sum_{t_2} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1 \pm 1} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 0  0 } &=
	0 \\
	\sum_{t_2} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1  0} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1  0 } &= 				\frac{1}{2} \\
	\sum_{t_2} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 1  0} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 0  0 } &=
	\text{sgn}(t_1) \frac{1}{2} = t_1 \\
	\sum_{t_2} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 0  0} \braket{ \frac{1}{2} t_1 \frac{1}{2} t_2 | 0  0 } &=
	\frac{1}{2}
\end{align*}
Yes, there are 10 terms here above if you take the $\pm$-signs into account. The first line only counts for $1$, the second, third and fourth lines each represent $2$ different combinations. Together with the last $3$ single combinations that makes $ 1 + 6 + 3 = 10$. Note that all the non zero terms have $M_T=M_T'$, and we may effectively include a $\delta_{M_T,M_T'}$ (which is done in Maarten's Code):
\begin{verbatim}
            if( t != 0 ) {
                if( t == -MT  )
                    continue;
                if( MT == 0 ) {
                    preifactor*= 0.5;
                    if( TA != TB ) preifactor *= t;
                }
            }
            if( t == 0 && TA != TB ) {
                continue;
            }
\end{verbatim}
\texttt{t} is equal to $2 t_1$. A value of \texttt{t=0} means summing over $t_1$ resulting in $\delta_{T T'}\delta_{M_T M_T'}$.
\section{Fourier transform of HO wave functions}
The HO Shr\"odinger equation is given by
\begin{align*}
\left( -\frac{\hbar^{2}}{2 m_N} \nabla^{2} + \frac{1}{2} m_N \omega^{2} r^{2} - E  \right) \psi(\vec{r}) = 0
\end{align*}
With $\nu = \frac{m_N \omega}{\hbar}$ (units 1/fm$^{2}$) and writing $E$ in units $\hbar \omega$ ($E \rightarrow \hbar \omega E$),
\begin{align*}
\left( -\frac{1}{2} \nabla^{2} + \frac{1}{2} \nu^{2} r^{2} - \nu E  \right) \psi(\vec{r}) = 0
\end{align*}
With solutions
\begin{align*}
	\psi_{n l m}(r) = \left[ \frac{ 2n!}{\Gamma(n+l+\frac{3}{2})} \nu^{l+\frac{3}{2}} \right]^{\frac{1}{2}} r^{l} e^{-\frac{\nu r^{2}}{2}} L_{n}^{l+\frac{1}{2}}( \nu r^{2}) Y_{l m}(\Omega_{r})
\end{align*}
The HO Shr\"odinger equation in momentum space is obtained by using $\hat{\vec{r}} = i \hbar \vec{\nabla}_{\vec{p}}$,
\begin{align*}
\left( \frac{p^{2}}{2 m_N} - \frac{1}{2} m_N \hbar^{2} \omega^{2} \nabla^{2} - E  \right) \phi(\vec{p}) = 0 
\end{align*}
Defining $\nu' = 1/\nu = \frac{\hbar}{m_N \omega}$ and writing the energy $E$ again in units of $\hbar \omega$ ($E \rightarrow \hbar \omega E$),
\begin{align*}
\left(- \frac{1}{2} \frac{\hbar^{2}}{\nu'} \nabla^{2} + \frac{\nu'}{\hbar^{2}} p^{2}  - E  \right) \phi(\vec{p}) = 0 
\end{align*}
If we define $\vec{p}$ in units $\hbar$ so that the dimension of $\vec{p}$ becomes $1/$fm we get ($\vec{p} \rightarrow \hbar \vec{p}$),
\begin{align*}
\left(- \frac{1}{2} \nabla^{2} + \nu'^{2} p^{2}  - \nu' E  \right) \phi(\vec{p}) = 0 
\end{align*}
This has exactly the same form as the Shr\"odinger equation in $r$-space. The solutions are,
\begin{align*}
	\phi_{n l m}(p) = \left[ \frac{ 2n!}{\Gamma(n+l+\frac{3}{2})} \nu'^{l+\frac{3}{2}} \right]^{\frac{1}{2}} p^{l} e^{-\frac{\nu' p^{2}}{2}} L_{n}^{l+\frac{1}{2}}( \nu' p^{2}) Y_{l m}(\Omega_{p})
\end{align*}
If you don't believe in the trick $\hat{\vec{r}} = i \hbar \vec{\nabla}_{p}$, we can also show this in a slightly more elaborate way, starting from the $r$-space Shr\"odinger equation and write (we will now explicitly put the $\hbar$'s in the exponents, this is generally omitted) $\psi_{n l m}(\vec{r})$ as $ \frac{1}{(2\pi \hbar)^{\frac{3}{2}}} \int \textrm{d}^{3} \vec{p} e^{i \vec{p} \cdot \vec{r} / \hbar} \phi_{n l m}(\vec{p})$,
\begin{align*}
\left( -\frac{1}{2} \nabla^{2} + \frac{1}{2} \nu^{2} r^{2} - \nu E  \right) \frac{1}{(2\pi \hbar)^{\frac{3}{2}}} \int \textrm{d}^{3} \vec{p} e^{i \vec{p} \cdot \vec{r} / \hbar} \phi_{n l m}(\vec{p}) = 0
\end{align*}
Noting that $\vec{r} \int \textrm{d}^{3} \vec{p} e^{i \vec{p} \cdot \vec{r} / \hbar} \psi_{n l m}(\vec{p})$ can be written as,
\begin{align*}
\vec{r} \int \textrm{d}^{3} \vec{p} e^{i \vec{p} \cdot \vec{r}/ \hbar} \psi_{n l m}(\vec{p}) &= \frac{\hbar}{i} \int \text{d}^{3} \vec{p} \, \left( \vec{\nabla}_{p} e^{i \vec{p} \cdot \vec{r}/ \hbar} \right) \phi_{n l m}(\vec{p}) \\
	&= \frac{\hbar}{i} \left[ e^{i \vec{p} \cdot \vec{r}/ \hbar } \phi_{ n l m}(\vec{p}) \right]^{+\infty}_{-\infty} - \frac{\hbar}{i}\int \text{d}^{3} \vec{p} \,  e^{i \vec{p} \cdot \vec{r} / \hbar} \left( \vec{\nabla_{p}} \phi_{n l m}(\vec{p}) \right) \\
	&= i \hbar \int \text{d}^{3} \vec{p} \,  e^{i \vec{p} \cdot \vec{r} / \hbar} \left( \vec{\nabla_{p}} \phi_{n l m}(\vec{p}) \right)
\end{align*}
and $\vec{\nabla} \int \textrm{d}^{3} \vec{p} e^{i \vec{p} \cdot \vec{r}/ \hbar} \phi_{n l m}(\vec{p}) = \int \textrm{d}^{3} \vec{p} \frac{i}{\hbar} \vec{p} e^{i \vec{p} \cdot \vec{r}} \phi_{n l m}(\vec{p}) $, we get,
\begin{align*}
\left( -\frac{1}{2} \nabla^{2} + \frac{1}{2} \nu^{2} r^{2} - \nu E  \right) \frac{1}{(2\pi \hbar)^{\frac{3}{2}}} \int \textrm{d}^{3} \vec{p} e^{i \vec{p} \cdot \vec{r}/ \hbar} \phi_{n l m}(\vec{p}) &= 0 \\
\Rightarrow \int \textrm{d}^{3} \vec{p} e^{i \vec{p} \cdot \vec{r}/ \hbar} \left( \frac{1}{2} \frac{p^{2}}{\hbar^{2}} - \frac{1}{2} \nu^{2} \hbar^{2} \nabla^{2}_{\vec{p}} - \nu E  \right) \phi_{n l m}(\vec{p}) = 0
\end{align*}
As this last line must be true for all $\vec{r}$ we must have that,
\begin{align*}
	\left( \frac{1}{2} \frac{p^{2}}{\hbar^{2}} - \frac{1}{2} \nu^{2} \hbar^{2} \nabla^{2}_{\vec{p}} - \nu E  \right)  \phi_{n l m}(\vec{p}) = 0
\end{align*}
Again redefining $\vec{p}$ in units $\hbar$ so that its dimension becomes $1/$fm instead of MeV/c. We get,
\begin{align*}
	\left(-\frac{1}{2}  \nabla^{2}_{\vec{p}} + \frac{1}{2} \frac{1}{\nu^{2}} p^{2} - \frac{1}{\nu} E  \right)  \phi_{n l m}(\vec{p}) &= 0 \\
\Rightarrow \left(-\frac{1}{2}  \nabla^{2}_{\vec{p}} + \frac{1}{2} \nu'^{2} p^{2} - \nu' E  \right)  \phi_{n l m}(\vec{p}) &= 0
\end{align*}
which is exactly what we set out to prove!
But let us try a even more elaborate way by taking the Fourier transform of the wave function in $r$-space!
\begin{align*}
	\phi_{n l m}(\vec{p}) &= \frac{1}{(2 \pi)^{\frac{3}{2}}}\int \text{d}^{3} \vec{r} \, e^{- i \vec{p} \cdot \vec{r}} \psi_{n l m}(\vec{r})\\
	&= \frac{1}{(2 \pi)^{\frac{3}{2}}} \left[ \frac{ 2n!}{\Gamma(n+l+\frac{3}{2})} \nu^{l+\frac{3}{2}} \right]^{\frac{1}{2}} \int \text{d}^{3} \vec{r} \,  e^{- i \vec{p} \cdot \vec{r}} r^{l} e^{-\frac{\nu r^{2}}{2}} L_{n}^{l+\frac{1}{2}}( \nu r^{2}) Y_{l m}(\Omega_{r})
\end{align*}
For the sake of conciseness We define $N_{nl} = \left[ \frac{ 2n!}{\Gamma(n+l+\frac{3}{2})} \nu^{l+\frac{3}{2}} \right]^{\frac{1}{2}}$. We use the plane wave expansion $ e^{- i \vec{p} \cdot \vec{r}} = (4 \pi) \sum_{k m_k} (-i)^{k} j_{k}( p r) Y_{k m_k}^{*}(\Omega_r) Y_{k m_k}(\Omega_p)$.
\begin{align*}
	\phi_{n l m}(\vec{p}) &= \frac{1}{(2 \pi)^{\frac{3}{2}}} \int \text{d}^{3} \vec{r} \, e^{- i \vec{p} \cdot \vec{r}} \psi_{n l m}(\vec{r})\\
	&=  N_{nl} \frac{4 \pi}{(2 \pi)^{\frac{3}{2}}} \sum_{k m_k} (-i)^{k}  Y_{k m_k}(\Omega_p) \int \text{d}r \, r^{2} j_{k}( p r) r^{l}  e^{-\frac{\nu r^{2}}{2}} L_{n}^{l+\frac{1}{2}}( \nu r^{2}) \int \text{d}^{2} \Omega_{r} \, Y_{k m_k}^{*}(\Omega_r) Y_{l m}(\Omega_{r}) \\
	&= N_{nl} \sqrt{ \frac{2}{\pi}} (-i)^{l}  Y_{l m}(\Omega_p) \int \text{d}r \, r^{2} j_{l}( p r) r^{l}  e^{-\frac{\nu r^{2}}{2}} L_{n}^{l+\frac{1}{2}}( \nu r^{2}) 
\end{align*}
Using the expansion of the spherical bessel function $j_l(x)$ and the generalized Laguerre polynomials $L_{n}^{l+\frac{1}{2}}(x)$ ,
\begin{align*}
	j_l(x) &= \sqrt{ \frac{\pi}{2 x}} J_{l+\frac{1}{2}}(x) = \sqrt{ \frac{\pi}{2 x}} J_{l+\frac{1}{2}}(x) = \sqrt{ \frac{\pi}{2 x}} \sum_{k=0}^{\infty} \frac{ (-1)^{k}}{k! \Gamma(k+l+3/2)} \left(\frac{x}{2}\right)^{2k+l+1/2} \\
	L_{n}^{l+\frac{1}{2}}(x) &= \sum_{j=0}^{n} (-1)^{j} \left( \begin{array}{c} n + l +1/2 \\ n - j \end{array} \right) \frac{x^j}{j!}
\end{align*}
\begin{multline*}
	\phi_{n l m}(\vec{p}) = N_{nl} \sqrt{ \frac{2}{\pi}} (-i)^{l}  Y_{l m}(\Omega_p) \\
	\int \text{d}r \, r^{2}  \sqrt{ \frac{\pi}{2 p r}} \sum_{k=0}^{\infty} \frac{ (-1)^{k}}{k! \Gamma(k+l+3/2)} \left(\frac{p r}{2}\right)^{2k+l+1/2} r^{l}  e^{-\frac{\nu r^{2}}{2}}  \sum_{j=0}^{n} (-1)^{j} \left( \begin{array}{c} n + l +1/2 \\ n - j \end{array} \right) \frac{(\nu r^{2})^j}{j!} \\
	=  N_{nl} (-i)^{l}  Y_{l m}(\Omega_p) \sum_{k=0}^{\infty} \sum_{j=0}^{n} \frac{ (-1)^{k+j}}{k! j! \Gamma(k+l+3/2)} \left( \begin{array}{c} n + l +1/2 \\ n - j \end{array} \right) \nu^{j} 2^{- 2k - l -\frac{1}{2} } p^{2k+l}\\
	\int \text{d}r \, r^{2}  r^{2k+2l}  e^{-\frac{\nu r^{2}}{2}} r^{2j} \\
\end{multline*}
TODO: CONTINUE CORRECTING BELOW!!!!
Looking at the $r$ integral separately we have,
\begin{multline*}
	\int \text{d}r \,   r^{2k+2l+2j+2}  e^{-\frac{\nu r^{2}}{2}} = \left( \frac{2}{\nu} \right)^{k+l+j+\frac{3}{2}} \int \text{d}r' \, r'^{2k+2l+2j+2} e^{-r'^{2}} = \left( \frac{2}{\nu} \right)^{k+l+j+\frac{3}{2}} \frac{1}{2} \Gamma \left( k + l + j + 3/2 \right) \\
	= 2^{k+l+j+\frac{1}{2}} \nu^{-k-l-j-\frac{3}{2}} \Gamma \left( k + l + j + 3/2 \right)
\end{multline*}
\begin{multline*}
	\phi_{n l m}(\vec{p}) =  N_{nl} (-i)^{l}  Y_{l m}(\Omega_p) p^{l} \nu^{-l-\frac{3}{2}} \\
	\sum_{k=0}^{\infty} \sum_{j=0}^{n} \frac{ (-1)^{k+j}}{k! j! \Gamma(k+l+3/2)} \left( \begin{array}{c} n + l +1/2 \\ n - j \end{array} \right) 2^{- k + j } p^{2k} \nu^{-k} \Gamma \left( k + l + j + 3/2 \right)\\
\end{multline*}
\end{document}
